<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>é€†å‘å­¦ä¹ 1.5åŠ å¯†ç®—æ³•ç¯‡å›½å¯† | Hanson&#39;s Blog</title>
<meta name="keywords" content="">
<meta name="description" content="å…³äºé€†å‘åŠ å¯†ç®—æ³•çš„ä¸€äº›å­¦ä¹ ï¼Œå›½å®¶åŠ å¯†æ ‡å‡†">
<meta name="author" content="
ä½œè€…:&nbsp;hanson">
<link rel="canonical" href="https://hanson00.github.io/posts/technology/python/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A01.5%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95%E7%AF%87%E5%9B%BD%E5%AF%86/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.845a44c8f19c77e054f472b3a0bacb3d33effea14f20590af5e97de848f8ab8b.css" integrity="sha256-hFpEyPGcd&#43;BU9HKzoLrLPTPv/qFPIFkK9el96Ej4q4s=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://hanson00.github.io/posts/imgs/66.jpg">
<link rel="icon" type="image/png" sizes="16x16" href="https://hanson00.github.io/posts/imgs/favicon16x16.ico">
<link rel="icon" type="image/png" sizes="32x32" href="https://hanson00.github.io/posts/imgs/favicon32x32.ico">
<link rel="apple-touch-icon" href="https://hanson00.github.io/posts/imgs/66.jpg">
<link rel="mask-icon" href="https://hanson00.github.io/posts/imgs/66.jpg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="é€†å‘å­¦ä¹ 1.5åŠ å¯†ç®—æ³•ç¯‡å›½å¯†" />
<meta property="og:description" content="å…³äºé€†å‘åŠ å¯†ç®—æ³•çš„ä¸€äº›å­¦ä¹ ï¼Œå›½å®¶åŠ å¯†æ ‡å‡†" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://hanson00.github.io/posts/technology/python/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A01.5%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95%E7%AF%87%E5%9B%BD%E5%AF%86/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-11-30T15:02:28&#43;08:00" />
<meta property="article:modified_time" content="2022-11-30T15:02:28&#43;08:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="é€†å‘å­¦ä¹ 1.5åŠ å¯†ç®—æ³•ç¯‡å›½å¯†"/>
<meta name="twitter:description" content="å…³äºé€†å‘åŠ å¯†ç®—æ³•çš„ä¸€äº›å­¦ä¹ ï¼Œå›½å®¶åŠ å¯†æ ‡å‡†"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://hanson00.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "ğŸ’»æŠ€æœ¯ç±»æ–‡ç« ",
      "item": "https://hanson00.github.io/posts/technology/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "Pythonæ–‡ç« ",
      "item": "https://hanson00.github.io/posts/technology/python/"
    }, 
    {
      "@type": "ListItem",
      "position":  4 ,
      "name": "é€†å‘å­¦ä¹ 1.5åŠ å¯†ç®—æ³•ç¯‡å›½å¯†",
      "item": "https://hanson00.github.io/posts/technology/python/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A01.5%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95%E7%AF%87%E5%9B%BD%E5%AF%86/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "é€†å‘å­¦ä¹ 1.5åŠ å¯†ç®—æ³•ç¯‡å›½å¯†",
  "name": "é€†å‘å­¦ä¹ 1.5åŠ å¯†ç®—æ³•ç¯‡å›½å¯†",
  "description": "å…³äºé€†å‘åŠ å¯†ç®—æ³•çš„ä¸€äº›å­¦ä¹ ï¼Œå›½å®¶åŠ å¯†æ ‡å‡†",
  "keywords": [
    ""
  ],
  "articleBody": "SMç³»åˆ— è¯´æ˜\n1  æœ¬æ•™ç¨‹ä»…ä¾›å­¦ä¹ äº¤æµä½¿ç”¨ï¼Œä¸¥ç¦ç”¨äºå•†ä¸šç”¨é€”å’Œéæ³•ç”¨é€”ï¼Œå¦åˆ™ç”±æ­¤äº§ç”Ÿçš„ä¸€åˆ‡åæœå‡ä¸ä½œè€…æ— å…³ï¼Œè¯·å„å­¦å‘˜è‡ªè§‰éµå®ˆç›¸å…³æ³•å¾‹æ³•è§„ã€‚   ç®—æ³•ç®€ä»‹ ä» 2010 å¹´å¼€å§‹ï¼Œæˆ‘å›½å›½å®¶å¯†ç ç®¡ç†å±€å°±å·²ç»å¼€å§‹é™†ç»­å‘å¸ƒäº†ä¸€ç³»åˆ—å›½äº§åŠ å¯†ç®—æ³•ï¼Œè¿™å…¶ä¸­å°±åŒ…æ‹¬ SM1ã€SM2ã€SM3 ã€SM4ã€SM7ã€SM9ã€ZUCï¼ˆç¥–å†²ä¹‹åŠ å¯†ç®—æ³•ï¼‰ç­‰ï¼ŒSM ä»£è¡¨å•†å¯†ï¼Œå³å•†ä¸šå¯†ç ï¼Œæ˜¯æŒ‡ç”¨äºå•†ä¸šçš„ã€ä¸æ¶‰åŠå›½å®¶ç§˜å¯†çš„å¯†ç æŠ€æœ¯ã€‚SM1 å’Œ SM7 çš„ç®—æ³•ä¸å…¬å¼€ï¼Œå…¶ä½™ç®—æ³•éƒ½å·²æˆä¸º ISO/IEC å›½é™…æ ‡å‡†ã€‚\nåœ¨è¿™äº›å›½äº§åŠ å¯†ç®—æ³•ä¸­ï¼ŒSM2ã€SM3ã€SM4  ä¸‰ç§åŠ å¯†ç®—æ³•æ˜¯æ¯”è¾ƒå¸¸è§çš„ï¼Œåœ¨çˆ¬å–éƒ¨åˆ†ç½‘ç«™æ—¶ï¼Œä¹Ÿå¯èƒ½ä¼šé‡åˆ°è¿™äº›ç®—æ³•.\nç®—æ³•åˆ†ç±»    ç®—æ³•åç§° ç®—æ³•ç±»åˆ« åº”ç”¨é¢†åŸŸ ç‰¹ç‚¹     SM1 å¯¹ç§°ï¼ˆåˆ†ç»„ï¼‰åŠ å¯†ç®—æ³• èŠ¯ç‰‡ åˆ†ç»„é•¿åº¦ã€å¯†é’¥é•¿åº¦å‡ä¸º 128 æ¯”ç‰¹   SM2 éå¯¹ç§°ï¼ˆåŸºäºæ¤­åœ†æ›²çº¿ ECCï¼‰åŠ å¯†ç®—æ³• æ•°æ®åŠ å¯† ECC æ¤­åœ†æ›²çº¿å¯†ç æœºåˆ¶ 256 ä½ï¼Œç›¸æ¯” RSA å¤„ç†é€Ÿåº¦å¿«ï¼Œæ¶ˆè€—æ›´å°‘   SM3 æ•£åˆ—ï¼ˆhashï¼‰å‡½æ•°ç®—æ³• å®Œæ•´æ€§æ ¡éªŒ å®‰å…¨æ€§åŠæ•ˆç‡ä¸ SHA-256 ç›¸å½“ï¼Œå‹ç¼©å‡½æ•°æ›´å¤æ‚   SM4 å¯¹ç§°ï¼ˆåˆ†ç»„ï¼‰åŠ å¯†ç®—æ³• æ•°æ®åŠ å¯†å’Œå±€åŸŸç½‘äº§å“ åˆ†ç»„é•¿åº¦ã€å¯†é’¥é•¿åº¦å‡ä¸º 128 æ¯”ç‰¹ï¼Œè®¡ç®—è½®æ•°å¤š   SM7 å¯¹ç§°ï¼ˆåˆ†ç»„ï¼‰åŠ å¯†ç®—æ³• éæ¥è§¦å¼ IC å¡ åˆ†ç»„é•¿åº¦ã€å¯†é’¥é•¿åº¦å‡ä¸º 128 æ¯”ç‰¹   SM9 æ ‡è¯†åŠ å¯†ç®—æ³•ï¼ˆIBEï¼‰ ç«¯å¯¹ç«¯ç¦»çº¿å®‰å…¨é€šè®¯ åŠ å¯†å¼ºåº¦ç­‰åŒäº 3072 ä½å¯†é’¥çš„ RSA åŠ å¯†ç®—æ³•   ZUC å¯¹ç§°ï¼ˆåºåˆ—ï¼‰åŠ å¯†ç®—æ³• ç§»åŠ¨é€šä¿¡ 4G ç½‘ç»œ æµå¯†ç     SM2 æ¤­åœ†æ›²çº¿å…¬é’¥åŠ å¯†ç®—æ³• SM2 ä¸ºæ¤­åœ†æ›²çº¿ï¼ˆECCï¼‰å…¬é’¥åŠ å¯†ç®—æ³•ï¼Œéå¯¹ç§°åŠ å¯†ï¼ŒSM2 ç®—æ³•å’Œ RSA ç®—æ³•éƒ½æ˜¯å…¬é’¥åŠ å¯†ç®—æ³•ï¼ŒSM2 ç®—æ³•æ˜¯ä¸€ç§æ›´å…ˆè¿›å®‰å…¨çš„ç®—æ³•ï¼Œåœ¨æˆ‘ä»¬å›½å®¶å•†ç”¨å¯†ç ä½“ç³»ä¸­è¢«ç”¨æ¥æ›¿æ¢ RSA ç®—æ³•ï¼Œåœ¨ä¸å°‘å®˜æ–¹ç½‘ç«™ä¼šè§åˆ°æ­¤ç±»åŠ å¯†ç®—æ³•ã€‚æˆ‘å›½å­¦è€…å¯¹æ¤­åœ†æ›²çº¿å¯†ç çš„ç ”ç©¶ä» 20 ä¸–çºª 80 å¹´ä»£å¼€å§‹ï¼Œç›®å‰å·²å–å¾—ä¸å°‘æˆæœï¼ŒSM2 æ¤­åœ†æ›²çº¿å…¬é’¥å¯†ç ç®—æ³•æ¯” RSA ç®—æ³•æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š\n    SM2 RSA     å®‰å…¨æ€§ 256 ä½ SM2 å¼ºåº¦å·²è¶…è¿‡ RSA-2048 ä¸€èˆ¬   ç®—æ³•ç»“æ„ åŸºæœ¬æ¤­åœ†æ›²çº¿ï¼ˆECCï¼‰ åŸºäºç‰¹æ®Šçš„å¯é€†æ¨¡å¹‚è¿ç®—   è®¡ç®—å¤æ‚åº¦ å®Œå…¨æŒ‡æ•°çº§ äºšæŒ‡æ•°çº§   å­˜å‚¨ç©ºé—´ï¼ˆå¯†é’¥é•¿åº¦ï¼‰ 192-256 bit 2048-4096 bit   ç§˜é’¥ç”Ÿæˆé€Ÿåº¦ è¾ƒ RSA ç®—æ³•å¿«ç™¾å€ä»¥ä¸Š æ…¢   è§£å¯†åŠ å¯†é€Ÿåº¦ è¾ƒå¿« ä¸€èˆ¬    SM4åˆ†ç»„åŠ å¯†ç®—æ³• SM4 ä¸ºæ— çº¿å±€åŸŸç½‘æ ‡å‡†çš„åˆ†ç»„åŠ å¯†ç®—æ³•ï¼Œå¯¹ç§°åŠ å¯†ï¼Œç”¨äºæ›¿ä»£ DES/AES ç­‰å›½é™…ç®—æ³•ï¼ŒSM4 ç®—æ³•ä¸ AES ç®—æ³•å…·æœ‰ç›¸åŒçš„å¯†é’¥é•¿åº¦å’Œåˆ†ç»„é•¿åº¦ï¼Œå‡ä¸º 128 ä½ï¼Œæ•…å¯¹æ¶ˆæ¯è¿›è¡ŒåŠ è§£å¯†æ—¶ï¼Œè‹¥æ¶ˆæ¯é•¿åº¦è¿‡é•¿ï¼Œéœ€è¦è¿›è¡Œåˆ†ç»„ï¼Œè¦æ¶ˆæ¯é•¿åº¦ä¸è¶³ï¼Œåˆ™è¦è¿›è¡Œå¡«å……ã€‚åŠ å¯†ç®—æ³•ä¸å¯†é’¥æ‰©å±•ç®—æ³•éƒ½é‡‡ç”¨ 32 è½®éçº¿æ€§è¿­ä»£ç»“æ„ï¼Œè§£å¯†ç®—æ³•ä¸åŠ å¯†ç®—æ³•çš„ç»“æ„ç›¸åŒï¼Œåªæ˜¯è½®å¯†é’¥çš„ä½¿ç”¨é¡ºåºç›¸åï¼Œè§£å¯†è½®å¯†é’¥æ˜¯åŠ å¯†è½®å¯†é’¥çš„é€†åºã€‚\n    SM4 DES AES     è®¡ç®—è½®æ•° 32 16ï¼ˆ3DES ä¸º 16*3ï¼‰ 10/12/14   å¯†ç éƒ¨ä»¶ S ç›’ã€éçº¿æ€§å˜æ¢ã€çº¿æ€§å˜æ¢ã€åˆæˆå˜æ¢ æ ‡å‡†ç®—æœ¯å’Œé€»è¾‘è¿ç®—ã€å…ˆæ›¿æ¢åç½®æ¢ï¼Œä¸å«çº¿æ€§å˜æ¢ S ç›’ã€è¡Œç§»ä½å˜æ¢ã€åˆ—æ··åˆå˜æ¢ã€åœˆå¯†é’¥åŠ å˜æ¢ï¼ˆAddRoundKeyï¼‰    sm2-JavaScriptè¿˜åŸ åœ¨ JavaScript ä¸­å·²æœ‰æ¯”è¾ƒæˆç†Ÿçš„å®ç°åº“ï¼Œè¿™é‡Œæ¨è sm-crypto[4]ï¼Œç›®å‰æ”¯æŒ SM2ã€SM3 å’Œ SM4ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒSM2 éå¯¹ç§°åŠ å¯†çš„ç»“æœç”± C1ã€C2ã€C3 ä¸‰éƒ¨åˆ†ç»„æˆï¼Œå…¶ä¸­ C1 æ˜¯ç”Ÿæˆéšæœºæ•°çš„è®¡ç®—å‡ºçš„æ¤­åœ†æ›²çº¿ç‚¹ï¼ŒC2 æ˜¯å¯†æ–‡æ•°æ®ï¼ŒC3 æ˜¯ SM3 çš„æ‘˜è¦å€¼ï¼Œæœ€å¼€å§‹çš„å›½å¯†æ ‡å‡†çš„ç»“æœæ˜¯æŒ‰ C1C2C3 é¡ºåºçš„ï¼Œæ–°æ ‡å‡†çš„æ˜¯æŒ‰ C1C3C2 é¡ºåºå­˜æ”¾çš„ï¼Œsm-crypto æ”¯æŒè®¾ç½® cipherModeï¼Œä¹Ÿå°±æ˜¯ C1C2C3 çš„æ’åˆ—é¡ºåºã€‚\nä»¥ SM2 ç®—æ³•ä¸ºä¾‹ï¼Œå®ç°å¦‚ä¸‹ï¼ˆå…¶ä»–ç®—æ³•å’Œè¯¦ç»†ç”¨æ³•å¯å‚è€ƒå…¶å®˜æ–¹æ–‡æ¡£ï¼‰ï¼š\nSM2 åŠ å¯†ï¼ˆencryptï¼‰å’Œè§£å¯†ï¼ˆdecryptï¼‰ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  // npm install sm-crypto --save  const sm2 = require('sm-crypto').sm2 // 1 - C1C3C2ï¼Œ0 - C1C2C3ï¼Œé»˜è®¤ä¸º1 const cipherMode = 1 // è·å–å¯†é’¥å¯¹ let keypair = sm2.generateKeyPairHex() let publicKey = keypair.publicKey // å…¬é’¥ let privateKey = keypair.privateKey // ç§é’¥  let msgString = \"this is the data to be encrypted\" let encryptData = sm2.doEncrypt(msgString, publicKey, cipherMode) // åŠ å¯†ç»“æœ let decryptData = sm2.doDecrypt(encryptData, privateKey, cipherMode) // è§£å¯†ç»“æœ  console.log(\"encryptData: \", encryptData) console.log(\"decryptData: \", decryptData)   sm2-pythonè¿˜åŸ åœ¨ Python é‡Œé¢å¹¶æ²¡æœ‰æ¯”è¾ƒå®˜æ–¹çš„åº“æ¥å®ç°å›½å¯†ç®—æ³•ï¼Œè¿™é‡Œä»…åˆ—å‡ºäº†å…¶ä¸­ä¸¤ä¸ªè¾ƒä¸ºå®Œå–„çš„ç¬¬ä¸‰æ–¹åº“ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒSM1 å’Œ SM7 ç®—æ³•ä¸å…¬å¼€ï¼Œç›®å‰å¤§å¤šåº“ä»…å®ç°äº† SM2ã€SM3ã€SM4 ä¸‰ç§å¯†ç®—æ³•ã€‚\nè‹¥è¦ä½¿ç”¨ SM9 ç®—æ³•ï¼Œå¯ä¸‹è½½ gmssl-python æºç æ‰‹åŠ¨å®‰è£…ã€‚\n1  pip install gmssl   pythonå®ç°åŠŸèƒ½ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  from gmssl import sm2 # 16 è¿›åˆ¶çš„å…¬é’¥å’Œç§é’¥ private_key = '00B9AB0B828FF68872F21A837FC303668428DEA11DCD1B24429D0C99E24EED83D5' public_key = 'B9C9A6E04E9C91F7BA880429273747D7EF5DDEB0BB2FF6317EB00BEF331A83081A6994B8993F3F5D6EADDDB81872266C87C018FB4162F5AF347B483E24620207' sm2_crypt = sm2.CryptSM2(public_key=public_key, private_key=private_key) # å¾…åŠ å¯†æ•°æ®å’ŒåŠ å¯†åæ•°æ®ä¸º bytes ç±»å‹ data = b\"this is the data to be encrypted\" enc_data = sm2_crypt.encrypt(data) dec_data = sm2_crypt.decrypt(enc_data) print('enc_data: ', enc_data.hex()) print('dec_data: ', dec_data)   sm4-JavaScriptè¿˜åŸ 1 2 3 4 5 6 7 8 9 10 11 12  const sm4 =require('sm-crypto').sm4 const msg='hel1o world!æˆ‘æ˜¯juneandgreen.'//å¯ä»¥ä¸ºutf8ä¸²æˆ–å­—èŠ‚æ•°ç»„ const key='0123456789abcdeffedcba9876543210'//å¯ä»¥ä¸º16è¿›åˆ¶ä¸²æˆ–å­—èŠ‚æ•°ç»„ï¼Œè¦æ±‚ä¸º128æ¯”ç‰¹ let encryptData1=sm4.encrypt(msg,key) //åŠ å¯†ï¼Œé»˜è®¤è¾“å‡ºI6è¿›åˆ¶å­—ç¬¦ä¸²ï¼Œé»˜è®¤ä½¿ç”¨pkcs#7å¡«å……ï¼ˆä¼ pkcs#5 ä¹Ÿä¼šèµ° pkcs#7 å¡«å……ï¼‰ let encryptData2=sm4.encrypt(msg,key,{padding:'none'}) //åŠ å¯†ï¼Œä¸ä½¿ç”¨padding let encryptData3=sm4.encrypt(msg,key,{padding:'none',output:'array'}) //åŠ ï¼Œä¸ä½¿ç”¨padding,è¾“å‡ºä¸ºå­—èŠ‚æ•°ç»„ let encryptData4= sm4.encrypt(msg,key,{mode:'cbc',iv:'fedcba98765432100123456789abcdef'}) //åŠ å¯†ï¼Œabcæ¨¡å¼  console.log(encryptData1) console.log(encryptData2) console.log(encryptData3) console.log(encryptData4)   ",
  "wordCount" : "1890",
  "inLanguage": "en",
  "datePublished": "2022-11-30T15:02:28+08:00",
  "dateModified": "2022-11-30T15:02:28+08:00",
  "author":[{
    "@type": "Person",
    "name": "hanson"
  }],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://hanson00.github.io/posts/technology/python/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A01.5%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95%E7%AF%87%E5%9B%BD%E5%AF%86/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Hanson's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://hanson00.github.io/posts/imgs/66.jpg"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://hanson00.github.io/" accesskey="h" title="Hanson&#39;s Blog (Alt + H)">Hanson&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://hanson00.github.io/search" title="ğŸ”æœç´¢ (Alt &#43; /)" accesskey=/>
                    <span>ğŸ”æœç´¢</span>
                </a>
            </li>
            <li>
                <a href="https://hanson00.github.io/" title="ğŸ ä¸»é¡µ">
                    <span>ğŸ ä¸»é¡µ</span>
                </a>
            </li>
            <li>
                <a href="https://hanson00.github.io/posts" title="ğŸ“šæ–‡ç« ">
                    <span>ğŸ“šæ–‡ç« </span>
                </a>
            </li>
            <li>
                <a href="https://hanson00.github.io/archives/" title="â±æ—¶é—´è½´">
                    <span>â±æ—¶é—´è½´</span>
                </a>
            </li>
            <li>
                <a href="https://hanson00.github.io/tags" title="ğŸ”–æ ‡ç­¾">
                    <span>ğŸ”–æ ‡ç­¾</span>
                </a>
            </li>
            <li>
                <a href="https://hanson00.github.io/about" title="ğŸ™‹ğŸ»â€â™‚ï¸å…³äº">
                    <span>ğŸ™‹ğŸ»â€â™‚ï¸å…³äº</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">

  <header class="post-header">
    <div class="breadcrumbs"><a href="https://hanson00.github.io/">Home</a>&nbsp;Â»&nbsp;<a href="https://hanson00.github.io/posts/">Posts</a>&nbsp;Â»&nbsp;<a href="https://hanson00.github.io/posts/technology/">ğŸ’»æŠ€æœ¯ç±»æ–‡ç« </a>&nbsp;Â»&nbsp;<a href="https://hanson00.github.io/posts/technology/python/">Pythonæ–‡ç« </a></div>
    <h1 class="post-title">
      é€†å‘å­¦ä¹ 1.5åŠ å¯†ç®—æ³•ç¯‡å›½å¯†
    </h1>
    <div class="post-description">
      å…³äºé€†å‘åŠ å¯†ç®—æ³•çš„ä¸€äº›å­¦ä¹ ï¼Œå›½å®¶åŠ å¯†æ ‡å‡†
    </div>
    <div class="post-meta">










æ›´æ–°:&nbsp;2022-11-30&nbsp;|&nbsp;å­—æ•°:&nbsp;1890å­—&nbsp;|&nbsp;æ—¶é•¿: 4åˆ†é’Ÿ&nbsp;|&nbsp;
ä½œè€…:&nbsp;hanson&nbsp;|&nbsp;æ ‡ç­¾: &nbsp;
      <ul class="post-tags-meta">
        <a href="https://hanson00.github.io/tags/%E9%80%86%E5%90%91/">é€†å‘</a>
        <a href="https://hanson00.github.io/tags/%E7%88%AC%E8%99%AB/">ã€çˆ¬è™«</a>
      </ul>

      <span id="busuanzi_container_page_pv">
        &nbsp;| è®¿é—®: <span id="busuanzi_value_page_pv"></span>
      </span>

</div>
  </header> <aside id="toc-container" class="toc-container wide">
        <div class="toc">
            <details  open>
                <summary accesskey="c" title="(Alt + C)">
                    <span class="details">Table of Contents</span>
                </summary>

                <div class="inner"><ul>
                        <li>
                            <a href="#sm%e7%b3%bb%e5%88%97" aria-label="SMç³»åˆ—">SMç³»åˆ—</a><ul>
                                    
                        <li>
                            <a href="#%e7%ae%97%e6%b3%95%e7%ae%80%e4%bb%8b" aria-label="ç®—æ³•ç®€ä»‹">ç®—æ³•ç®€ä»‹</a></li>
                        <li>
                            <a href="#%e7%ae%97%e6%b3%95%e5%88%86%e7%b1%bb" aria-label="ç®—æ³•åˆ†ç±»">ç®—æ³•åˆ†ç±»</a><ul>
                                    
                        <li>
                            <a href="#sm2-%e6%a4%ad%e5%9c%86%e6%9b%b2%e7%ba%bf%e5%85%ac%e9%92%a5%e5%8a%a0%e5%af%86%e7%ae%97%e6%b3%95" aria-label="SM2 æ¤­åœ†æ›²çº¿å…¬é’¥åŠ å¯†ç®—æ³•">SM2 æ¤­åœ†æ›²çº¿å…¬é’¥åŠ å¯†ç®—æ³•</a></li>
                        <li>
                            <a href="#sm4%e5%88%86%e7%bb%84%e5%8a%a0%e5%af%86%e7%ae%97%e6%b3%95" aria-label="SM4åˆ†ç»„åŠ å¯†ç®—æ³•">SM4åˆ†ç»„åŠ å¯†ç®—æ³•</a><ul>
                                    
                        <li>
                            <a href="#sm2-javascript%e8%bf%98%e5%8e%9f" aria-label="sm2-JavaScriptè¿˜åŸ">sm2-JavaScriptè¿˜åŸ</a></li>
                        <li>
                            <a href="#sm2-python%e8%bf%98%e5%8e%9f" aria-label="sm2-pythonè¿˜åŸ">sm2-pythonè¿˜åŸ</a><ul>
                                    
                        <li>
                            <a href="#python%e5%ae%9e%e7%8e%b0%e5%8a%9f%e8%83%bd" aria-label="pythonå®ç°åŠŸèƒ½">pythonå®ç°åŠŸèƒ½</a></li></ul>
                        </li>
                        <li>
                            <a href="#sm4-javascript%e8%bf%98%e5%8e%9f" aria-label="sm4-JavaScriptè¿˜åŸ">sm4-JavaScriptè¿˜åŸ</a>
                        </li>
                    </ul>
                    </li>
                    </ul>
                    </li>
                    </ul>
                    </li>
                    </ul>
                </div>
            </details>
        </div>
    </aside>
    <script>
        let activeElement;
        let elements;
        window.addEventListener('DOMContentLoaded', function (event) {
            checkTocPosition();

            elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
            
            activeElement = elements[0];
            const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
            document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
        }, false);

        window.addEventListener('resize', function (event) {
            checkTocPosition();
        }, false);

        window.addEventListener('scroll', () => {
            
            activeElement = Array.from(elements).find((element) => {
                if ((getOffsetTop(element) - window.pageYOffset) > 0 &&
                    (getOffsetTop(element) - window.pageYOffset) < window.innerHeight / 2) {
                    return element;
                }
            }) || activeElement

            elements.forEach(element => {
                const id = encodeURI(element.getAttribute('id')).toLowerCase();
                if (element === activeElement) {
                    document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
                } else {
                    document.querySelector(`.inner ul li a[href="#${id}"]`).classList.remove('active');
                }
            })
        }, false);

        const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
        const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
        const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);

        function checkTocPosition() {
            const width = document.body.scrollWidth;

            if (width - main - (toc * 2) - (gap * 4) > 0) {
                document.getElementById("toc-container").classList.add("wide");
            } else {
                document.getElementById("toc-container").classList.remove("wide");
            }
        }

        function getOffsetTop(element) {
            if (!element.getClientRects().length) {
                return 0;
            }
            let rect = element.getBoundingClientRect();
            let win = element.ownerDocument.defaultView;
            return rect.top + win.pageYOffset;
        }
    </script>
  <div class="post-content"><h1 id="smç³»åˆ—">SMç³»åˆ—<a hidden class="anchor" aria-hidden="true" href="#smç³»åˆ—">#</a></h1>
<p><strong>è¯´æ˜</strong></p>
<div class="highlight"><div style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">æœ¬æ•™ç¨‹ä»…ä¾›å­¦ä¹ äº¤æµä½¿ç”¨ï¼Œä¸¥ç¦ç”¨äºå•†ä¸šç”¨é€”å’Œéæ³•ç”¨é€”ï¼Œå¦åˆ™ç”±æ­¤äº§ç”Ÿçš„ä¸€åˆ‡åæœå‡ä¸ä½œè€…æ— å…³ï¼Œè¯·å„å­¦å‘˜è‡ªè§‰éµå®ˆç›¸å…³æ³•å¾‹æ³•è§„ã€‚
</code></pre></td></tr></table>
</div>
</div><h2 id="ç®—æ³•ç®€ä»‹">ç®—æ³•ç®€ä»‹<a hidden class="anchor" aria-hidden="true" href="#ç®—æ³•ç®€ä»‹">#</a></h2>
<p>ä» 2010 å¹´å¼€å§‹ï¼Œæˆ‘å›½å›½å®¶å¯†ç ç®¡ç†å±€å°±å·²ç»å¼€å§‹é™†ç»­å‘å¸ƒäº†ä¸€ç³»åˆ—å›½äº§åŠ å¯†ç®—æ³•ï¼Œè¿™å…¶ä¸­å°±åŒ…æ‹¬ <code>SM1ã€SM2ã€SM3 ã€SM4ã€SM7ã€SM9ã€ZUC</code>ï¼ˆç¥–å†²ä¹‹åŠ å¯†ç®—æ³•ï¼‰ç­‰ï¼Œ<code>SM</code> ä»£è¡¨å•†å¯†ï¼Œå³å•†ä¸šå¯†ç ï¼Œæ˜¯æŒ‡ç”¨äºå•†ä¸šçš„ã€ä¸æ¶‰åŠå›½å®¶ç§˜å¯†çš„å¯†ç æŠ€æœ¯ã€‚<code>SM1</code> å’Œ <code>SM7 </code>çš„ç®—æ³•ä¸å…¬å¼€ï¼Œå…¶ä½™ç®—æ³•éƒ½å·²æˆä¸º<code> ISO/IEC</code> å›½é™…æ ‡å‡†ã€‚</p>
<p>åœ¨è¿™äº›å›½äº§åŠ å¯†ç®—æ³•ä¸­ï¼Œ<code>SM2ã€SM3ã€SM4 </code> <strong>ä¸‰ç§åŠ å¯†ç®—æ³•æ˜¯æ¯”è¾ƒå¸¸è§çš„</strong>ï¼Œåœ¨çˆ¬å–éƒ¨åˆ†ç½‘ç«™æ—¶ï¼Œä¹Ÿå¯èƒ½ä¼šé‡åˆ°è¿™äº›ç®—æ³•.</p>
<h2 id="ç®—æ³•åˆ†ç±»">ç®—æ³•åˆ†ç±»<a hidden class="anchor" aria-hidden="true" href="#ç®—æ³•åˆ†ç±»">#</a></h2>
<table>
<thead>
<tr>
<th style="text-align:center">ç®—æ³•åç§°</th>
<th style="text-align:center">ç®—æ³•ç±»åˆ«</th>
<th style="text-align:center">åº”ç”¨é¢†åŸŸ</th>
<th style="text-align:center">ç‰¹ç‚¹</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">SM1</td>
<td style="text-align:center">å¯¹ç§°ï¼ˆåˆ†ç»„ï¼‰åŠ å¯†ç®—æ³•</td>
<td style="text-align:center">èŠ¯ç‰‡</td>
<td style="text-align:center">åˆ†ç»„é•¿åº¦ã€å¯†é’¥é•¿åº¦å‡ä¸º 128 æ¯”ç‰¹</td>
</tr>
<tr>
<td style="text-align:center">SM2</td>
<td style="text-align:center">éå¯¹ç§°ï¼ˆåŸºäºæ¤­åœ†æ›²çº¿ ECCï¼‰åŠ å¯†ç®—æ³•</td>
<td style="text-align:center">æ•°æ®åŠ å¯†</td>
<td style="text-align:center">ECC æ¤­åœ†æ›²çº¿å¯†ç æœºåˆ¶ 256 ä½ï¼Œç›¸æ¯” RSA å¤„ç†é€Ÿåº¦å¿«ï¼Œæ¶ˆè€—æ›´å°‘</td>
</tr>
<tr>
<td style="text-align:center">SM3</td>
<td style="text-align:center">æ•£åˆ—ï¼ˆhashï¼‰å‡½æ•°ç®—æ³•</td>
<td style="text-align:center">å®Œæ•´æ€§æ ¡éªŒ</td>
<td style="text-align:center">å®‰å…¨æ€§åŠæ•ˆç‡ä¸ SHA-256 ç›¸å½“ï¼Œå‹ç¼©å‡½æ•°æ›´å¤æ‚</td>
</tr>
<tr>
<td style="text-align:center">SM4</td>
<td style="text-align:center">å¯¹ç§°ï¼ˆåˆ†ç»„ï¼‰åŠ å¯†ç®—æ³•</td>
<td style="text-align:center">æ•°æ®åŠ å¯†å’Œå±€åŸŸç½‘äº§å“</td>
<td style="text-align:center">åˆ†ç»„é•¿åº¦ã€å¯†é’¥é•¿åº¦å‡ä¸º 128 æ¯”ç‰¹ï¼Œè®¡ç®—è½®æ•°å¤š</td>
</tr>
<tr>
<td style="text-align:center">SM7</td>
<td style="text-align:center">å¯¹ç§°ï¼ˆåˆ†ç»„ï¼‰åŠ å¯†ç®—æ³•</td>
<td style="text-align:center">éæ¥è§¦å¼ IC å¡</td>
<td style="text-align:center">åˆ†ç»„é•¿åº¦ã€å¯†é’¥é•¿åº¦å‡ä¸º 128 æ¯”ç‰¹</td>
</tr>
<tr>
<td style="text-align:center">SM9</td>
<td style="text-align:center">æ ‡è¯†åŠ å¯†ç®—æ³•ï¼ˆIBEï¼‰</td>
<td style="text-align:center">ç«¯å¯¹ç«¯ç¦»çº¿å®‰å…¨é€šè®¯</td>
<td style="text-align:center">åŠ å¯†å¼ºåº¦ç­‰åŒäº 3072 ä½å¯†é’¥çš„ RSA åŠ å¯†ç®—æ³•</td>
</tr>
<tr>
<td style="text-align:center">ZUC</td>
<td style="text-align:center">å¯¹ç§°ï¼ˆåºåˆ—ï¼‰åŠ å¯†ç®—æ³•</td>
<td style="text-align:center">ç§»åŠ¨é€šä¿¡ 4G ç½‘ç»œ</td>
<td style="text-align:center">æµå¯†ç </td>
</tr>
</tbody>
</table>
<h3 id="sm2-æ¤­åœ†æ›²çº¿å…¬é’¥åŠ å¯†ç®—æ³•">SM2 æ¤­åœ†æ›²çº¿å…¬é’¥åŠ å¯†ç®—æ³•<a hidden class="anchor" aria-hidden="true" href="#sm2-æ¤­åœ†æ›²çº¿å…¬é’¥åŠ å¯†ç®—æ³•">#</a></h3>
<p><code>SM2</code> ä¸ºæ¤­åœ†æ›²çº¿ï¼ˆ<code>ECC</code>ï¼‰å…¬é’¥åŠ å¯†ç®—æ³•ï¼Œéå¯¹ç§°åŠ å¯†ï¼Œ<code>SM2</code> ç®—æ³•å’Œ <code>RSA </code>ç®—æ³•éƒ½æ˜¯å…¬é’¥åŠ å¯†ç®—æ³•ï¼Œ<code>SM2</code> ç®—æ³•æ˜¯ä¸€ç§æ›´å…ˆè¿›å®‰å…¨çš„ç®—æ³•ï¼Œåœ¨æˆ‘ä»¬å›½å®¶å•†ç”¨å¯†ç ä½“ç³»ä¸­è¢«ç”¨æ¥æ›¿æ¢<code> RSA</code> ç®—æ³•ï¼Œåœ¨ä¸å°‘å®˜æ–¹ç½‘ç«™ä¼šè§åˆ°æ­¤ç±»åŠ å¯†ç®—æ³•ã€‚æˆ‘å›½å­¦è€…å¯¹æ¤­åœ†æ›²çº¿å¯†ç çš„ç ”ç©¶ä» 20 ä¸–çºª 80 å¹´ä»£å¼€å§‹ï¼Œç›®å‰å·²å–å¾—ä¸å°‘æˆæœï¼Œ<code>SM2</code> æ¤­åœ†æ›²çº¿å…¬é’¥å¯†ç ç®—æ³•æ¯” <code>RSA </code>ç®—æ³•æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š</p>
<table>
<thead>
<tr>
<th></th>
<th>SM2</th>
<th>RSA</th>
</tr>
</thead>
<tbody>
<tr>
<td>å®‰å…¨æ€§</td>
<td>256 ä½ SM2 å¼ºåº¦å·²è¶…è¿‡ RSA-2048</td>
<td>ä¸€èˆ¬</td>
</tr>
<tr>
<td>ç®—æ³•ç»“æ„</td>
<td>åŸºæœ¬æ¤­åœ†æ›²çº¿ï¼ˆECCï¼‰</td>
<td>åŸºäºç‰¹æ®Šçš„å¯é€†æ¨¡å¹‚è¿ç®—</td>
</tr>
<tr>
<td>è®¡ç®—å¤æ‚åº¦</td>
<td>å®Œå…¨æŒ‡æ•°çº§</td>
<td>äºšæŒ‡æ•°çº§</td>
</tr>
<tr>
<td>å­˜å‚¨ç©ºé—´ï¼ˆå¯†é’¥é•¿åº¦ï¼‰</td>
<td>192-256 bit</td>
<td>2048-4096 bit</td>
</tr>
<tr>
<td>ç§˜é’¥ç”Ÿæˆé€Ÿåº¦</td>
<td>è¾ƒ RSA ç®—æ³•å¿«ç™¾å€ä»¥ä¸Š</td>
<td>æ…¢</td>
</tr>
<tr>
<td>è§£å¯†åŠ å¯†é€Ÿåº¦</td>
<td>è¾ƒå¿«</td>
<td>ä¸€èˆ¬</td>
</tr>
</tbody>
</table>
<h3 id="sm4åˆ†ç»„åŠ å¯†ç®—æ³•">SM4åˆ†ç»„åŠ å¯†ç®—æ³•<a hidden class="anchor" aria-hidden="true" href="#sm4åˆ†ç»„åŠ å¯†ç®—æ³•">#</a></h3>
<p><code>SM4</code> ä¸ºæ— çº¿å±€åŸŸç½‘æ ‡å‡†çš„åˆ†ç»„åŠ å¯†ç®—æ³•ï¼Œå¯¹ç§°åŠ å¯†ï¼Œç”¨äºæ›¿ä»£ <code>DES/AES</code> ç­‰å›½é™…ç®—æ³•ï¼Œ<code>SM4</code> ç®—æ³•ä¸ <code>AES </code>ç®—æ³•å…·æœ‰ç›¸åŒçš„å¯†é’¥é•¿åº¦å’Œåˆ†ç»„é•¿åº¦ï¼Œå‡ä¸º 128 ä½ï¼Œæ•…å¯¹æ¶ˆæ¯è¿›è¡ŒåŠ è§£å¯†æ—¶ï¼Œè‹¥æ¶ˆæ¯é•¿åº¦è¿‡é•¿ï¼Œéœ€è¦è¿›è¡Œåˆ†ç»„ï¼Œè¦æ¶ˆæ¯é•¿åº¦ä¸è¶³ï¼Œåˆ™è¦è¿›è¡Œå¡«å……ã€‚åŠ å¯†ç®—æ³•ä¸å¯†é’¥æ‰©å±•ç®—æ³•éƒ½é‡‡ç”¨ 32 è½®éçº¿æ€§è¿­ä»£ç»“æ„ï¼Œè§£å¯†ç®—æ³•ä¸åŠ å¯†ç®—æ³•çš„ç»“æ„ç›¸åŒï¼Œåªæ˜¯è½®å¯†é’¥çš„ä½¿ç”¨é¡ºåºç›¸åï¼Œè§£å¯†è½®å¯†é’¥æ˜¯åŠ å¯†è½®å¯†é’¥çš„é€†åºã€‚</p>
<table>
<thead>
<tr>
<th></th>
<th>SM4</th>
<th>DES</th>
<th>AES</th>
</tr>
</thead>
<tbody>
<tr>
<td>è®¡ç®—è½®æ•°</td>
<td>32</td>
<td>16ï¼ˆ3DES ä¸º 16*3ï¼‰</td>
<td>10/12/14</td>
</tr>
<tr>
<td>å¯†ç éƒ¨ä»¶</td>
<td>S ç›’ã€éçº¿æ€§å˜æ¢ã€çº¿æ€§å˜æ¢ã€åˆæˆå˜æ¢</td>
<td>æ ‡å‡†ç®—æœ¯å’Œé€»è¾‘è¿ç®—ã€å…ˆæ›¿æ¢åç½®æ¢ï¼Œä¸å«çº¿æ€§å˜æ¢</td>
<td>S ç›’ã€è¡Œç§»ä½å˜æ¢ã€åˆ—æ··åˆå˜æ¢ã€åœˆå¯†é’¥åŠ å˜æ¢ï¼ˆAddRoundKeyï¼‰</td>
</tr>
</tbody>
</table>
<h4 id="sm2-javascriptè¿˜åŸ">sm2-JavaScriptè¿˜åŸ<a hidden class="anchor" aria-hidden="true" href="#sm2-javascriptè¿˜åŸ">#</a></h4>
<p>åœ¨ JavaScript ä¸­å·²æœ‰æ¯”è¾ƒæˆç†Ÿçš„å®ç°åº“ï¼Œè¿™é‡Œæ¨è <code>sm-crypto[4]</code>ï¼Œç›®å‰æ”¯æŒ<code> SM2ã€SM3 å’Œ SM4</code>ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒSM2 éå¯¹ç§°åŠ å¯†çš„ç»“æœç”± <code>C1ã€C2ã€C3</code> ä¸‰éƒ¨åˆ†ç»„æˆï¼Œå…¶ä¸­ <code>C1</code> æ˜¯ç”Ÿæˆéšæœºæ•°çš„è®¡ç®—å‡ºçš„æ¤­åœ†æ›²çº¿ç‚¹ï¼Œ<code>C2 </code>æ˜¯å¯†æ–‡æ•°æ®ï¼Œ<code>C3 </code>æ˜¯<code> SM3</code> çš„æ‘˜è¦å€¼ï¼Œæœ€å¼€å§‹çš„å›½å¯†æ ‡å‡†çš„ç»“æœæ˜¯æŒ‰ <code>C1C2C3</code> é¡ºåºçš„ï¼Œæ–°æ ‡å‡†çš„æ˜¯æŒ‰ <code>C1C3C2</code> é¡ºåºå­˜æ”¾çš„ï¼Œ<code>sm-crypto</code> æ”¯æŒè®¾ç½®<code> cipherMode</code>ï¼Œä¹Ÿå°±æ˜¯ <code>C1C2C3</code> çš„æ’åˆ—é¡ºåºã€‚</p>
<p>ä»¥ <code>SM2 </code>ç®—æ³•ä¸ºä¾‹ï¼Œå®ç°å¦‚ä¸‹ï¼ˆå…¶ä»–ç®—æ³•å’Œè¯¦ç»†ç”¨æ³•å¯å‚è€ƒå…¶å®˜æ–¹æ–‡æ¡£ï¼‰ï¼š</p>
<p><code>SM2 </code>åŠ å¯†ï¼ˆencryptï¼‰å’Œè§£å¯†ï¼ˆdecryptï¼‰ï¼š</p>
<div class="highlight"><div style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#0080ff;font-style:italic">// npm install sm-crypto --save
</span><span style="color:#0080ff;font-style:italic"></span>
<span style="color:#2c5dcd;font-weight:bold">const</span> sm2 <span style="color:#2c5dcd">=</span> require(<span style="color:#0c6">&#39;sm-crypto&#39;</span>).sm2
 
<span style="color:#0080ff;font-style:italic">// 1 - C1C3C2ï¼Œ0 - C1C2C3ï¼Œé»˜è®¤ä¸º1
</span><span style="color:#0080ff;font-style:italic"></span><span style="color:#2c5dcd;font-weight:bold">const</span> cipherMode <span style="color:#2c5dcd">=</span> <span style="color:#5918bb;font-weight:bold">1</span>
 
<span style="color:#0080ff;font-style:italic">// è·å–å¯†é’¥å¯¹
</span><span style="color:#0080ff;font-style:italic"></span><span style="color:#2c5dcd;font-weight:bold">let</span> keypair <span style="color:#2c5dcd">=</span> sm2.generateKeyPairHex()
<span style="color:#2c5dcd;font-weight:bold">let</span> publicKey <span style="color:#2c5dcd">=</span> keypair.publicKey   <span style="color:#0080ff;font-style:italic">// å…¬é’¥
</span><span style="color:#0080ff;font-style:italic"></span><span style="color:#2c5dcd;font-weight:bold">let</span> privateKey <span style="color:#2c5dcd">=</span> keypair.privateKey <span style="color:#0080ff;font-style:italic">// ç§é’¥
</span><span style="color:#0080ff;font-style:italic"></span> 
<span style="color:#2c5dcd;font-weight:bold">let</span> msgString <span style="color:#2c5dcd">=</span> <span style="color:#0c6">&#34;this is the data to be encrypted&#34;</span>
<span style="color:#2c5dcd;font-weight:bold">let</span> encryptData <span style="color:#2c5dcd">=</span> sm2.doEncrypt(msgString, publicKey, cipherMode)    <span style="color:#0080ff;font-style:italic">// åŠ å¯†ç»“æœ
</span><span style="color:#0080ff;font-style:italic"></span><span style="color:#2c5dcd;font-weight:bold">let</span> decryptData <span style="color:#2c5dcd">=</span> sm2.doDecrypt(encryptData, privateKey, cipherMode) <span style="color:#0080ff;font-style:italic">// è§£å¯†ç»“æœ
</span><span style="color:#0080ff;font-style:italic"></span> 
console.log(<span style="color:#0c6">&#34;encryptData: &#34;</span>, encryptData)
console.log(<span style="color:#0c6">&#34;decryptData: &#34;</span>, decryptData)
</code></pre></td></tr></table>
</div>
</div><h4 id="sm2-pythonè¿˜åŸ">sm2-pythonè¿˜åŸ<a hidden class="anchor" aria-hidden="true" href="#sm2-pythonè¿˜åŸ">#</a></h4>
<p>åœ¨ Python é‡Œé¢å¹¶æ²¡æœ‰æ¯”è¾ƒå®˜æ–¹çš„åº“æ¥å®ç°å›½å¯†ç®—æ³•ï¼Œè¿™é‡Œä»…åˆ—å‡ºäº†å…¶ä¸­ä¸¤ä¸ªè¾ƒä¸ºå®Œå–„çš„ç¬¬ä¸‰æ–¹åº“ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<code>SM1 å’Œ SM7</code> ç®—æ³•ä¸å…¬å¼€ï¼Œç›®å‰å¤§å¤šåº“ä»…å®ç°äº† <code>SM2ã€SM3ã€SM4</code> ä¸‰ç§å¯†ç®—æ³•ã€‚</p>
<p>è‹¥è¦ä½¿ç”¨ <code>SM9</code> ç®—æ³•ï¼Œå¯ä¸‹è½½ <code>gmssl-python</code> æºç æ‰‹åŠ¨å®‰è£…ã€‚</p>
<div class="highlight"><div style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">pip install gmssl
</code></pre></td></tr></table>
</div>
</div><h5 id="pythonå®ç°åŠŸèƒ½">pythonå®ç°åŠŸèƒ½<a hidden class="anchor" aria-hidden="true" href="#pythonå®ç°åŠŸèƒ½">#</a></h5>
<div class="highlight"><div style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#2c5dcd;font-weight:bold">from</span> gmssl <span style="color:#2c5dcd;font-weight:bold">import</span> sm2
 
 
<span style="color:#0080ff;font-style:italic"># 16 è¿›åˆ¶çš„å…¬é’¥å’Œç§é’¥</span>
private_key <span style="color:#2c5dcd">=</span> <span style="color:#0c6">&#39;00B9AB0B828FF68872F21A837FC303668428DEA11DCD1B24429D0C99E24EED83D5&#39;</span>
public_key <span style="color:#2c5dcd">=</span> <span style="color:#0c6">&#39;B9C9A6E04E9C91F7BA880429273747D7EF5DDEB0BB2FF6317EB00BEF331A83081A6994B8993F3F5D6EADDDB81872266C87C018FB4162F5AF347B483E24620207&#39;</span>
sm2_crypt <span style="color:#2c5dcd">=</span> sm2<span style="color:#2c5dcd">.</span>CryptSM2(public_key<span style="color:#2c5dcd">=</span>public_key, private_key<span style="color:#2c5dcd">=</span>private_key)
 
<span style="color:#0080ff;font-style:italic"># å¾…åŠ å¯†æ•°æ®å’ŒåŠ å¯†åæ•°æ®ä¸º bytes ç±»å‹</span>
data <span style="color:#2c5dcd">=</span> <span style="color:#0c6">b</span><span style="color:#0c6">&#34;this is the data to be encrypted&#34;</span>
enc_data <span style="color:#2c5dcd">=</span> sm2_crypt<span style="color:#2c5dcd">.</span>encrypt(data)
dec_data <span style="color:#2c5dcd">=</span> sm2_crypt<span style="color:#2c5dcd">.</span>decrypt(enc_data)
 
<span style="color:#5918bb;font-weight:bold">print</span>(<span style="color:#0c6">&#39;enc_data: &#39;</span>, enc_data<span style="color:#2c5dcd">.</span>hex())
<span style="color:#5918bb;font-weight:bold">print</span>(<span style="color:#0c6">&#39;dec_data: &#39;</span>, dec_data)
</code></pre></td></tr></table>
</div>
</div><h4 id="sm4-javascriptè¿˜åŸ">sm4-JavaScriptè¿˜åŸ<a hidden class="anchor" aria-hidden="true" href="#sm4-javascriptè¿˜åŸ">#</a></h4>
<div class="highlight"><div style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#2c5dcd;font-weight:bold">const</span> sm4 <span style="color:#2c5dcd">=</span>require(<span style="color:#0c6">&#39;sm-crypto&#39;</span>).sm4
<span style="color:#2c5dcd;font-weight:bold">const</span> msg<span style="color:#2c5dcd">=</span><span style="color:#0c6">&#39;hel1o world!æˆ‘æ˜¯juneandgreen.&#39;</span><span style="color:#0080ff;font-style:italic">//å¯ä»¥ä¸ºutf8ä¸²æˆ–å­—èŠ‚æ•°ç»„
</span><span style="color:#0080ff;font-style:italic"></span><span style="color:#2c5dcd;font-weight:bold">const</span> key<span style="color:#2c5dcd">=</span><span style="color:#0c6">&#39;0123456789abcdeffedcba9876543210&#39;</span><span style="color:#0080ff;font-style:italic">//å¯ä»¥ä¸º16è¿›åˆ¶ä¸²æˆ–å­—èŠ‚æ•°ç»„ï¼Œè¦æ±‚ä¸º128æ¯”ç‰¹
</span><span style="color:#0080ff;font-style:italic"></span><span style="color:#2c5dcd;font-weight:bold">let</span> encryptData1<span style="color:#2c5dcd">=</span>sm4.encrypt(msg,key)    <span style="color:#0080ff;font-style:italic">//åŠ å¯†ï¼Œé»˜è®¤è¾“å‡ºI6è¿›åˆ¶å­—ç¬¦ä¸²ï¼Œé»˜è®¤ä½¿ç”¨pkcs#7å¡«å……ï¼ˆä¼ pkcs#5 ä¹Ÿä¼šèµ° pkcs#7 å¡«å……ï¼‰
</span><span style="color:#0080ff;font-style:italic"></span><span style="color:#2c5dcd;font-weight:bold">let</span> encryptData2<span style="color:#2c5dcd">=</span>sm4.encrypt(msg,key,{padding<span style="color:#2c5dcd">:</span><span style="color:#0c6">&#39;none&#39;</span>})   <span style="color:#0080ff;font-style:italic">//åŠ å¯†ï¼Œä¸ä½¿ç”¨padding
</span><span style="color:#0080ff;font-style:italic"></span><span style="color:#2c5dcd;font-weight:bold">let</span> encryptData3<span style="color:#2c5dcd">=</span>sm4.encrypt(msg,key,{padding<span style="color:#2c5dcd">:</span><span style="color:#0c6">&#39;none&#39;</span>,output<span style="color:#2c5dcd">:</span><span style="color:#0c6">&#39;array&#39;</span>})    <span style="color:#0080ff;font-style:italic">//åŠ ï¼Œä¸ä½¿ç”¨padding,è¾“å‡ºä¸ºå­—èŠ‚æ•°ç»„
</span><span style="color:#0080ff;font-style:italic"></span><span style="color:#2c5dcd;font-weight:bold">let</span> encryptData4<span style="color:#2c5dcd">=</span> sm4.encrypt(msg,key,{mode<span style="color:#2c5dcd">:</span><span style="color:#0c6">&#39;cbc&#39;</span>,iv<span style="color:#2c5dcd">:</span><span style="color:#0c6">&#39;fedcba98765432100123456789abcdef&#39;</span>})    <span style="color:#0080ff;font-style:italic">//åŠ å¯†ï¼Œabcæ¨¡å¼
</span><span style="color:#0080ff;font-style:italic"></span>
console.log(encryptData1)
console.log(encryptData2)
console.log(encryptData3)
console.log(encryptData4)
</code></pre></td></tr></table>
</div>
</div>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://hanson00.github.io/tags/%E9%80%86%E5%90%91/">é€†å‘</a></li>
      <li><a href="https://hanson00.github.io/tags/%E7%88%AC%E8%99%AB/">çˆ¬è™«</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://hanson00.github.io/posts/technology/python/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A01.5%E6%B7%B7%E6%B7%86%E7%AF%87/">
    <span class="title">Â« Prev</span>
    <br>
    <span>é€†å‘å­¦ä¹ 1.5æ··æ·†ç¯‡</span>
  </a>
  <a class="next" href="https://hanson00.github.io/posts/technology/python/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0-webpack/">
    <span class="title">Next Â»</span>
    <br>
    <span>é€†å‘å­¦ä¹  Webpack</span>
  </a>
</nav>

  </footer>
<div>
    <div class="pagination__title">
        <span class="pagination__title-h" style="font-size: 20px;">ğŸ’¬è¯„è®º</span>âœ¨æ˜µç§°è¾“å…¥QQå·å¯ä»¥è‡ªåŠ¨å…³è”âœ¨
        <hr />

    </div>
    <div id="tcomment"></div>
    <script src="https://cdn.staticfile.org/twikoo/1.5.11/twikoo.all.min.js"></script>
    <script>
        twikoo.init({
            envId: "https://twikoo1-mu.vercel.app/",  
            el: "#tcomment",
            lang: 'zh-CN',
            region: 'ap-guangzhou',  
            path: window.TWIKOO_MAGIC_PATH || window.location.pathname,
        });
    </script>
</div>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2023 <a href="https://hanson00.github.io/">Hanson&#39;s Blog</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
