<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>æå·çˆ¬è™« | Hanson&#39;s Blog</title>
<meta name="keywords" content="çˆ¬è™«å®æˆ˜,çˆ¬è™«,çˆ¬è™«é¡¹ç›®,çˆ¬è™«å­¦ä¹ ">
<meta name="description" content="Bç«™æå·çˆ¬è™«å­¦ä¹ æ€»ç»“">
<meta name="author" content="
ä½œè€…:&nbsp;hanson">
<link rel="canonical" href="https://hanson00.github.io/posts/technology/python/%E6%9D%8E%E5%B7%8D%E7%88%AC%E8%99%AB/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.90e638a5d4448bfb1fe445aebfe0f00ba8831874539fc42477608012af462729.css" integrity="sha256-kOY4pdREi/sf5EWuv&#43;DwC6iDGHRTn8Qkd2CAEq9GJyk=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://hanson00.github.io/posts/imgs/66.jpg">
<link rel="icon" type="image/png" sizes="16x16" href="https://hanson00.github.io/posts/imgs/favicon16x16.ico">
<link rel="icon" type="image/png" sizes="32x32" href="https://hanson00.github.io/posts/imgs/favicon32x32.ico">
<link rel="apple-touch-icon" href="https://hanson00.github.io/posts/imgs/66.jpg">
<link rel="mask-icon" href="https://hanson00.github.io/posts/imgs/66.jpg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="æå·çˆ¬è™«" />
<meta property="og:description" content="Bç«™æå·çˆ¬è™«å­¦ä¹ æ€»ç»“" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://hanson00.github.io/posts/technology/python/%E6%9D%8E%E5%B7%8D%E7%88%AC%E8%99%AB/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-06-26T17:13:41&#43;08:00" />
<meta property="article:modified_time" content="2022-06-26T17:13:41&#43;08:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="æå·çˆ¬è™«"/>
<meta name="twitter:description" content="Bç«™æå·çˆ¬è™«å­¦ä¹ æ€»ç»“"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://hanson00.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "ğŸ’»æŠ€æœ¯ç±»æ–‡ç« ",
      "item": "https://hanson00.github.io/posts/technology/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "Pythonæ–‡ç« ",
      "item": "https://hanson00.github.io/posts/technology/python/"
    }, 
    {
      "@type": "ListItem",
      "position":  4 ,
      "name": "æå·çˆ¬è™«",
      "item": "https://hanson00.github.io/posts/technology/python/%E6%9D%8E%E5%B7%8D%E7%88%AC%E8%99%AB/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "æå·çˆ¬è™«",
  "name": "æå·çˆ¬è™«",
  "description": "Bç«™æå·çˆ¬è™«å­¦ä¹ æ€»ç»“",
  "keywords": [
    "çˆ¬è™«å®æˆ˜,çˆ¬è™«,çˆ¬è™«é¡¹ç›®,çˆ¬è™«å­¦ä¹ "
  ],
  "articleBody": "çˆ¬è™«åŸºç¡€ çˆ¬è™«åŸºæœ¬æµç¨‹\n1.åˆå§‹åŒ–URLï¼Œå¹¶å°†URLæ”¾å…¥å¾…çˆ¬å–çš„é˜Ÿåˆ— 2.å°†URlé€šè¿‡DNSè§£æIPï¼Œå°†å¯¹åº”IPçš„ç«™ç‚¹ä¸‹è½½åˆ°HTMLé¡µé¢ï¼Œå¹¶ä¿å­˜åˆ°æœ¬åœ°ï¼Œçˆ¬å–å®Œçš„URLæ”¾åˆ°å·²çˆ¬å–é˜Ÿåˆ— 3.åˆ†æç½‘é¡µå†…å®¹ï¼Œæ‰¾å‡ºç½‘é¡µé‡Œé¢å…³å¿ƒçš„URLé“¾æ¥å’Œå†…å®¹ï¼Œç»§ç»­æ‰§è¡Œç¬¬äºŒæ­¥\n è·å–ç½‘é¡µ æå–ä¿¡æ¯ ä¿å­˜æ•°æ® è‡ªåŠ¨åŒ–ç¨‹åº  çˆ¬è™«å¦‚æœéœ€è¦æ¨¡æ‹Ÿåˆ™æŠŠè¯¥ç½‘ç«™ä¸‹é¢çš„æ‰€æœ‰è¯·æ±‚ä¿¡æ¯å°è£…(ä¾‹å¦‚UA)ç„¶åå‘é€\nHTTPè¯·æ±‚æ–¹æ³• è¯·æ±‚ï¼Œæ˜¯ç”±å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘å‡ºä¸€èˆ¬åˆ†ä¸º4éƒ¨åˆ†å†…å®¹ï¼šè¯·æ±‚æ–¹æ³•ï¼ˆrequest methodï¼‰ã€è¯·æ±‚çš„ç½‘å€ï¼ˆrequest urlï¼‰ã€è¯·æ±‚å¤´ï¼ˆrequest Headersï¼‰ã€è¯·æ±‚ä½“ï¼ˆrequest Bodyï¼‰\n   1 GET è¯·æ±‚æŒ‡å®šçš„é¡µé¢ä¿¡æ¯ï¼Œå¹¶è¿”å›å®ä½“ä¸»ä½“ã€‚     2 HEAD ç±»ä¼¼äº GET è¯·æ±‚ï¼Œåªä¸è¿‡è¿”å›çš„å“åº”ä¸­æ²¡æœ‰å…·ä½“çš„å†…å®¹ï¼Œç”¨äºè·å–æŠ¥å¤´   3 POST å‘æŒ‡å®šèµ„æºæäº¤æ•°æ®è¿›è¡Œå¤„ç†è¯·æ±‚ï¼ˆä¾‹å¦‚æäº¤è¡¨å•æˆ–è€…ä¸Šä¼ æ–‡ä»¶ï¼‰ã€‚æ•°æ®è¢«åŒ…å«åœ¨è¯·æ±‚ä½“ä¸­ã€‚POST è¯·æ±‚å¯èƒ½ä¼šå¯¼è‡´æ–°çš„èµ„æºçš„å»ºç«‹å’Œ/æˆ–å·²æœ‰èµ„æºçš„ä¿®æ”¹ã€‚   4 PUT ä»å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ä¼ é€çš„æ•°æ®å–ä»£æŒ‡å®šçš„æ–‡æ¡£çš„å†…å®¹ã€‚   5 DELETE è¯·æ±‚æœåŠ¡å™¨åˆ é™¤æŒ‡å®šçš„é¡µé¢ã€‚   6 CONNECT HTTP/1.1 åè®®ä¸­é¢„ç•™ç»™èƒ½å¤Ÿå°†è¿æ¥æ”¹ä¸ºç®¡é“æ–¹å¼çš„ä»£ç†æœåŠ¡å™¨ã€‚   7 OPTIONS å…è®¸å®¢æˆ·ç«¯æŸ¥çœ‹æœåŠ¡å™¨çš„æ€§èƒ½ã€‚   8 TRACE å›æ˜¾æœåŠ¡å™¨æ”¶åˆ°çš„è¯·æ±‚ï¼Œä¸»è¦ç”¨äºæµ‹è¯•æˆ–è¯Šæ–­ã€‚   9 PATCH æ˜¯å¯¹ PUT æ–¹æ³•çš„è¡¥å……ï¼Œç”¨æ¥å¯¹å·²çŸ¥èµ„æºè¿›è¡Œå±€éƒ¨æ›´æ–° ã€‚    è¯·æ±‚å¤´ è¯·æ±‚å¤´ï¼Œç”¨æ¥è¯´æ˜æœåŠ¡å™¨è¦ä½¿ç”¨çš„é™„åŠ ä¿¡æ¯ï¼Œæ¯”è¾ƒé‡è¦çš„ä¿¡æ¯æœ‰ï¼Œcookieã€Referã€User-Agent\nå“åº” å“åº”ï¼Œç”±æœåŠ¡å™¨ç«¯è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œåˆ†ä¸ºå“åº”çŠ¶æ€ç ï¼ˆResponse Status Codeï¼‰ã€å“åº”å¤´ï¼ˆResponse headersï¼‰ã€å“åº”ä½“ï¼ˆResponse Bodyï¼‰\nå“åº”å¤´ åŒ…å«äº†æœåŠ¡å™¨å¯¹è¯·æ±‚çš„åº”ç­”ä¿¡æ¯\n å°çŸ¥è¯†  Host:åŸŸåã€‚è¡¨ç¤ºè¯·æ±‚çš„æœåŠ¡å™¨ç½‘å€   çˆ¬è™«åˆ†ç±» é€šç”¨çˆ¬è™« èšç„¦çˆ¬è™«  çˆ¬è™«å­¦ä¹  urllib.request.urlopen(url, data=None, [timeout, ]*, cafile=None, capath=None, cadefault=False, context=None)æ‰“å¼€ä¸€ä¸ªç½‘é¡µå¹¶æŠŠè·å–è¯¥URLçš„ç½‘é¡µå¯¹è±¡ data å¿…é¡»æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œç”¨äºç»™å‡ºè¦å‘é€åˆ°æœåŠ¡å™¨çš„é™„åŠ æ•°æ®ï¼Œè‹¥ä¸éœ€è¦å‘é€æ•°æ®åˆ™ä¸º Noneï¼Œdataæ”¯æŒçš„å¯¹è±¡ç±»å‹åŒ…æ‹¬å­—èŠ‚ä¸²ã€ç±»æ–‡ä»¶å¯¹è±¡å’Œå¯éå†çš„ç±»å­—èŠ‚ä¸²å¯¹è±¡\nurllib.request.urlopen()  ä¸€ä¸ªç®€å•çš„getè¯·æ±‚çˆ¬å–\n 1 2 3 4 5 6 7 8 9 10 11  import urllib.request import urllib.parse #è§£æå™¨ import urllib.error #Getè¯·æ±‚ response = urllib.request.urlopen(\"http://www.baidu.com\") print(response.read().decode(\"UTF-8\"))\t# responseæ˜¯ url = \"http://httpbin.org/get\" response2 = urllib.request.urlopen(url=url) print(response2.read().decode(\"UTF-8\"))    ä¸€ä¸ªç®€å•çš„postè¯·æ±‚(postè¯·æ±‚éœ€è¦æäº¤ä¸ªè¡¨å•ä¿¡æ¯)ï¼Œéœ€è¦æä¾›ä¸€ä¸ªå°è£…çš„æ•°æ®\n 1 2 3 4 5  #postè¯·æ±‚ éœ€è¦å°è£…æ•°æ® http://httpbin.org/post url = \"http://httpbin.org/post\" data = bytes(urllib.parse.urlencode({\"hello\":\"world\"}), encoding = \"utf-8\")\t#æŠŠæ•°æ®å˜æˆäºŒè¿›åˆ¶æ ¼å¼ response = urllib.request.urlopen(url=url, data=data) print(response.read().decode(\"utf-8\"))   urllib.request.Request() urllib.request.Request(url, data=None, headers={}, origin_req_host=None, unverifiable=False, method=None) ä¸Šé¢çš„urlopenè¿‡äºç®€å•ç›´æ¥æŠŠèµ‹å€¼çš„urlç›´æ¥æ‰“å¼€ï¼ŒåŒ…å«ä¸äº†å¤ªå¤šä¼ªè£…ä¿¡æ¯ï¼Œæ‰€ä»¥ä½¿ç”¨==urllib.request.Request()==\nheadersï¼šå‘Šè¯‰è¦è®¿é—®çš„æœåŠ¡å™¨ï¼Œæˆ‘ä»¬æ˜¯ä»€ä¹ˆç±»å‹çš„æœºå™¨ï¼ˆæµè§ˆå™¨ï¼‰ï¼Œæœ¬è´¨ä¸Šæ˜¯å‘Šè¯‰æµè§ˆå™¨æˆ‘ä»¬å¯ä»¥æ¥å—ä»€ä¹ˆæ°´å¹³çš„æ–‡ä»¶å†…å®¹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14  import urllib.request import urllib.parse #è§£æå™¨ import urllib.error # http://httpbin.org/post https://www.douban.com url = \"http://httpbin.org/post\" headers = {\"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36\" \" (KHTML, like Gecko) Chrome/97.0.4692.99 Safari/537.36\"} data = bytes(urllib.parse.urlencode({\"name\":\"hanson\"}),encoding = \"UTF-8\") #å°è£…äº†ä¸€ä¸ªè¯·æ±‚å¯¹è±¡ req = urllib.request.Request(url=url, data=data, headers=headers) response = urllib.request.urlopen(req)\t#å“åº”å¯¹è±¡ print(response.read().decode(\"UTF-8\"))   ç®€å•çš„çˆ¬å–ç½‘é¡µ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47  import urllib.request import urllib.error def main(): #åŸºç¡€çš„URL # 1.çˆ¬å–ç½‘é¡µ baseurl = \"https://movie.douban.com/top250?start=\" savepath = r\"D:\\project\\python pycharm\\datasave\\douban_data.xlsx\" # datalist = getData(baseurl) getData(baseurl) #2.è§£ææ•°æ® #3.ä¿å­˜æ•°æ® # saveData(savepath) def getData(baseurl): datalist = [] for i in range(0, 10): url = baseurl + str(i*25) html = askurl(url) return datalist # 3.ä¿å­˜æ•°æ®,åœ¨æœ¬åˆ—å­ä¸­æš‚æ—¶ä¸ç”¨ def saveData(savepath): pass # å¾—åˆ°ä¸€ä¸ªæŒ‡å®šçš„URLçš„ç½‘é¡µå†…å®¹ def askurl(url): head = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36\" \" (KHTML, like Gecko) Chrome/97.0.4692.99 Safari/537.36\" } html = \"\" try: req = urllib.request.Request(url=url, headers=head) response = urllib.request.urlopen(req) html= response.read().decode(\"UTF-8\") print(html) except Exception as e: print(e) return html if __name__ == \"__main__\": main()   BeautifulSoupåº“çš„åŸºæœ¬ä½¿ç”¨(çˆ¬è™«çš„è§£æ) BeautifulSoup4å°†HTMLæ–‡æ¡£è½¬æ¢æˆæ ‘å½¢ç»“æ„ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯Pythonå¯¹è±¡ï¼Œå½’ç±»æˆå››ç§ï¼š\n Tag\tå¯ä»¥è·å–æ ‡ç­¾åŠå…¶æ ‡ç­¾å†…å®¹ NavigableString BeautifulSoup comment  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20  import bs4 with open(\"../baidu.html\", \"rb\") as file: htmlread = file.read() bs = bs4.BeautifulSoup(htmlread, \"html.parser\") # Tag è·å–æ ‡ç­¾åŠå†…å®¹ print(bs.title) #output: ç™¾åº¦ä¸€ä¸‹ï¼Œä½ å°±çŸ¥é“  print(bs.a) #output:  # è·å–æ ‡ç­¾é‡Œé¢çš„å†…å®¹ print(bs.title.string) #output: ç™¾åº¦ä¸€ä¸‹ï¼Œä½ å°±çŸ¥é“ print(bs.a.string) #output: æ–°é—» # NavigableString è·å–æ ‡ç­¾é‡Œçš„æ‰€æœ‰å±æ€§ï¼Œå¹¶è¿”å›ä¸€ä¸ªå­—å…¸ print(bs.a.attrs) #attrsæ˜¯attributeå±æ€§çš„ç¼©å†™ # print(bs) æ‰“å°æ•´ä¸ªhtmlæ–‡ä»¶ # æ–‡ä»¶çš„éå† contents print(\"-----æ–‡æ¡£çš„éå†-----\") print(bs.head.contents) #è¿”å›ä¸€ä¸ªåˆ—è¡¨   BeautifulSoup2.0æ–‡æ¡£æœç´¢ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45  import re import bs4 with open(\"../baidu.html\", \"rb\") as file: htmlread = file.read() bs = bs4.BeautifulSoup(htmlread, \"html.parser\") #æ–‡æ¡£æœç´¢ # 1. find_all()æ–¹æ³•:å­—ç¬¦ä¸²è¿‡æ»¤ä¼šæŸ¥æ‰¾ä¸å­—ç¬¦ä¸²å®Œå…¨åŒ¹é…çš„å†…å®¹ list = bs.find_all(\"a\") # list = bs.find_all(\"a\", limit = 3) limité™åˆ¶å¤šå°‘ print(list) #æ­£åˆ™è¡¨è¾¾å¼æœç´¢ print(\"---æ­£åˆ™è¡¨è¾¾å¼æœç´¢---\") re_list = bs.find_all(re.compile(\"a\")) print(re_list) print(len(re_list)) #ä¼ å…¥ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°è¿›è¡Œæœç´¢,æŒ‰ç…§å‡½æ•°è¿›è¡Œæœç´¢ print(\"---å‡½æ•°æœç´¢---\") def name_is_exists(tag): return tag.has_attr(\"name\") funcres = bs.find_all(name_is_exists) print(funcres) #kwargså…³é”®å­—æœç´¢ print(\"----kwargså…³é”®å­—æœç´¢----\") kwlist = bs.find_all(id = \"head\") kwlist2 = bs.find_all(href = \"https://www.hao123.com\") kwlist3 = bs.find_all(class_ = True) #è¿™é‡ŒclassåŠ ä¸‹åˆ’çº¿æ˜¯å› ä¸ºclassæ˜¯Pythonçš„å…³é”®å­— print(kwlist3) #textæ–‡æœ¬å‚æ•°,æŸ¥æ‰¾æ ‡ç­¾é‡Œçš„å­—ç¬¦ä¸² print(\"----textæ–‡æœ¬å‚æ•°-----\") ts_list = bs.find_all(text=\"hao123\") ts_list2 = bs.find_all(text=[\"hao123\", \"åœ°å›¾\"]) print(ts_list2) #cssé€‰æ‹©å™¨,å’Œcssé€‰æ‹©å™¨çš„è¯­æ³•ä¸€æ · print(\"------cssé€‰æ‹©å™¨-------\") css_list = bs.select(\"title\") css_list2 = bs.select(\".mnav\") css_list3 = bs.select(\"#u1\") css_list4 = bs.select(\"a[class = 'bri']\") print(css_list3)   liweiçˆ¬è™«å­¦ä¹ çš„æœ€ç»ˆ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108  # coding:utf-8 # @Time : 2022/5/7 9:57 # @Author : è½¯ä»¶1194æ¸©é“­å†› # @file : ts.py # $software : PyCharm import bs4 import re import xlwt import urllib.request import urllib.error def main(): baseurl = \"https://movie.douban.com/top250?start=\" #å¾…çˆ¬å–çš„URL savepath = r\"D:\\project\\python pycharm\\datasave\\douban_data.xls\" #ä¿å­˜ä½ç½® datalist = getData(baseurl) #çˆ¬å–åˆ°çš„æ•°æ®åˆ—è¡¨ # getData(baseurl) # print(datalist) #3.ä¿å­˜æ•°æ® saveData(datalist,savepath) # æå–å½±ç‰‡çš„æå–è§„åˆ™ recom_link = re.compile(r'') recom_img = re.compile(r'', re.S) #re.Sè®©æ¢è¡Œç¬¦ä¹ŸåŒ…å«åœ¨å†… recom_title = re.compile(r'(.*?)') recom_rating = re.compile(r'(.*?)') recom_judge = re.compile(r'(\\d*)äººè¯„ä»·') recom_inq = re.compile(r'(.*?)') recom_db = re.compile(r'(.*?)\n',re.S) def getData(baseurl): datalist = [] #ç”Ÿæˆè¦çˆ¬å–çš„ç½‘å€ for i in range(0, 10): url = baseurl + str(i*25) html = askurl(url) #è¿›è¡Œæ•°æ®è§£æ soup = bs4.BeautifulSoup(html, \"html.parser\") for item in soup.find_all(\"div\", class_ = \"item\"):\t#åœ¨ä¸­æŸ¥æ‰¾æ˜¯divå¹¶ä¸”class=\"item\"çš„å†…å®¹ # print(item) data = [] #ä¿å­˜æ¯ä¸€éƒ¨ç”µå½±çš„ä¿¡æ¯ item = str(item) link = re.findall(recom_link, item)[0] data.append(link) #æ·»åŠ é“¾æ¥ img = re.findall(recom_img, item)[0] data.append(img) title = re.findall(recom_title, item) if (len(title) ==2): ctitle = title[0] data.append(ctitle) otitle = title[1].replace(\"/\",\"\") #å»æ‰æ— å…³ç¬¦å· data.append(otitle) else: data.append(title[0]) data.append(\" \") #ç•™ç©º rating = re.findall(recom_rating, item)[0] data.append(rating) judge = re.findall(recom_judge, item)[0] data.append(judge) inq = re.findall(recom_inq, item) if len(inq) !=0: inq = inq[0].replace(\"ã€‚\", \" \") data.append(inq) else: data.append(\" \") db = re.findall(recom_db, item)[0] db = re.sub('(\\s+)?', \"\", db) db = re.sub('/', \" \", db) data.append(db.strip()) datalist.append(data) # print(datalist) return datalist # 3.ä¿å­˜æ•°æ® def saveData(datalist,savepath): wb = xlwt.Workbook(encoding=\"UTF-8\") ws = wb.add_sheet(\"douban_dataTOP250\") col = (\"ç”µå½±è¯¦æƒ…é“¾æ¥\", \"å›¾ç‰‡é“¾æ¥\", \"å½±ç‰‡ä¸­æ–‡å\", \"å½±ç‰‡å¤–å›½å\", \"è¯„åˆ†\", \"è¯„ä»·æ•°\", \"æ¦‚å†µ\", \"ç›¸å…³ä¿¡æ¯\") for i in range(0,8): ws.write(0,i,col[i]) #åˆ—å for i in range(0,250): print(\"ç¬¬%dæ¡\" %(i+1)) data = datalist[i] for j in range(0,8): ws.write(i+1,j,data[j]) #å†™å…¥æ•°æ® wb.save(savepath) #ä¿å­˜ # å¾—åˆ°ä¸€ä¸ªæŒ‡å®šçš„URLçš„ç½‘é¡µå†…å®¹ def askurl(url): head = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36\" \" (KHTML, like Gecko) Chrome/97.0.4692.99 Safari/537.36\" } html = \"\" try: req = urllib.request.Request(url=url, headers=head) response = urllib.request.urlopen(req) html= response.read().decode(\"UTF-8\") # print(html) except Exception as e: print(e) return html if __name__ == \"__main__\": main() print(\"çˆ¬å–å®Œæ¯•\")   çˆ¬è™«æ‰€ç”¨åˆ°çš„åº“ bs4(beautifulsoup)\nurllib\nreæ­£åˆ™è¡¨è¾¾å¼  re.L è¡¨ç¤ºç‰¹æ®Šå­—ç¬¦é›† \\w, \\W, \\b, \\B, \\s, \\S ä¾èµ–äºå½“å‰ç¯å¢ƒ re.M å¤šè¡Œæ¨¡å¼ re.S å³ä¸º' . â€˜å¹¶ä¸”åŒ…æ‹¬æ¢è¡Œç¬¦åœ¨å†…çš„ä»»æ„å­—ç¬¦ï¼ˆâ€™ . â€˜ä¸åŒ…æ‹¬æ¢è¡Œç¬¦ï¼‰ re.U è¡¨ç¤ºç‰¹æ®Šå­—ç¬¦é›† \\w, \\W, \\b, \\B, \\d, \\D, \\s, \\S ä¾èµ–äº Unicode å­—ç¬¦å±æ€§æ•°æ®åº“ re.X ä¸ºäº†å¢åŠ å¯è¯»æ€§ï¼Œå¿½ç•¥ç©ºæ ¼å’Œâ€™ # â€˜åé¢çš„æ³¨é‡Š   ==æ³¨æ„==:\n é™¤äº†txtçº¯æ–‡æœ¬æ–‡ä»¶ä½¿ç”¨ræ¥è¯»å–ï¼Œå…¶ä»–ç±»å‹çš„æ–‡ä»¶éƒ½æ˜¯äºŒè¿›åˆ¶æ–‡ä»¶ç”¨rbè¯»å– ä¹±ç é—®é¢˜ï¼šPythonå†…å­˜å±‚é¢ä½¿ç”¨çš„æ˜¯Unicodeç¼–ç ï¼Œè€ŒUnicodeä¸èƒ½å­˜å‚¨å’Œä¼ è¾“çš„ï¼Œå¿…é¡»æŠŠUnicodeç¼–ç è¿›è¡Œè½¬ç (å†™æ–‡ä»¶æ—¶è¦ç¼–ç ï¼Œè¯»æ–‡ä»¶æ—¶è¦è§£ç )ï¼Œè½¬æ¢æˆUTF-8æˆ–è€…GBK å¾—åˆ°çš„bâ€™å­—ç¬¦ä¸²â€™æ˜¯==å­—èŠ‚==ï¼Œéœ€è¦è½¬ç  åœ¨å·²ç»çˆ¬å–å¾—åˆ°ç½‘é¡µåè¿›è¡Œæ•°æ®è§£ææ—¶ï¼Œå¦‚æœæµ‹è¯•æ­£åˆ™è¡¨è¾¾å¼æ²¡æœ‰é—®é¢˜ä½†ä»æ— æ•°æ®æ—¶ï¼Œå¯ä»¥åŠ ä¸Šre.Sä¹‹ç±»çš„re.compile(pattern[, flags])çš„flagå‚æ•° å½“ä½¿ç”¨BeautifulSoupçš„find(å‚æ•°)å‚æ•°ä¸­å‡ºç°Pythonå…³é”®å­—æ—¶å¯ä»¥åœ¨å…³é”®å­—åé¢åŠ __(PS: class_ = \"å€¼\")  1 2 3  #å¦‚ä¸‹é¢ä¸¤ç§å†™æ³•ä¸€æ · find(classs_=\"table\") find(attrs={\"class\":\"table\"})   BeautifulSoupä¸­å¦‚æœæƒ³æ‹¿åˆ°æŸä¸ªå±æ€§çš„å€¼ï¼Œå¯ä»¥ä½¿ç”¨get(â€œè¦è·å–çš„å±æ€§åâ€)æ–¹æ³•  ",
  "wordCount" : "3637",
  "inLanguage": "en",
  "datePublished": "2022-06-26T17:13:41+08:00",
  "dateModified": "2022-06-26T17:13:41+08:00",
  "author":[{
    "@type": "Person",
    "name": "hanson"
  }],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://hanson00.github.io/posts/technology/python/%E6%9D%8E%E5%B7%8D%E7%88%AC%E8%99%AB/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Hanson's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://hanson00.github.io/posts/imgs/66.jpg"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://hanson00.github.io/" accesskey="h" title="Hanson&#39;s Blog (Alt + H)">Hanson&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://hanson00.github.io/search" title="ğŸ”æœç´¢ (Alt &#43; /)" accesskey=/>
                    <span>ğŸ”æœç´¢</span>
                </a>
            </li>
            <li>
                <a href="https://hanson00.github.io/" title="ğŸ ä¸»é¡µ">
                    <span>ğŸ ä¸»é¡µ</span>
                </a>
            </li>
            <li>
                <a href="https://hanson00.github.io/posts" title="ğŸ“šæ–‡ç« ">
                    <span>ğŸ“šæ–‡ç« </span>
                </a>
            </li>
            <li>
                <a href="https://hanson00.github.io/archives/" title="â±æ—¶é—´è½´">
                    <span>â±æ—¶é—´è½´</span>
                </a>
            </li>
            <li>
                <a href="https://hanson00.github.io/tags" title="ğŸ”–æ ‡ç­¾">
                    <span>ğŸ”–æ ‡ç­¾</span>
                </a>
            </li>
            <li>
                <a href="https://hanson00.github.io/about" title="ğŸ™‹ğŸ»â€â™‚ï¸å…³äº">
                    <span>ğŸ™‹ğŸ»â€â™‚ï¸å…³äº</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://hanson00.github.io/">Home</a>&nbsp;Â»&nbsp;<a href="https://hanson00.github.io/posts/">Posts</a>&nbsp;Â»&nbsp;<a href="https://hanson00.github.io/posts/technology/">ğŸ’»æŠ€æœ¯ç±»æ–‡ç« </a>&nbsp;Â»&nbsp;<a href="https://hanson00.github.io/posts/technology/python/">Pythonæ–‡ç« </a></div>
    <h1 class="post-title">
      æå·çˆ¬è™«
    </h1>
    <div class="post-description">
      Bç«™æå·çˆ¬è™«å­¦ä¹ æ€»ç»“
    </div>
    <div class="post-meta">














8 min&nbsp;|&nbsp;3637 words&nbsp;|&nbsp;
ä½œè€…:&nbsp;hanson&nbsp;|&nbsp;

</div>
  </header> <aside id="toc-container" class="toc-container wide">
        <div class="toc">
            <details  open>
                <summary accesskey="c" title="(Alt + C)">
                    <span class="details">Table of Contents</span>
                </summary>

                <div class="inner"><ul>
                        <li>
                            <a href="#%e7%88%ac%e8%99%ab%e5%9f%ba%e7%a1%80" aria-label="çˆ¬è™«åŸºç¡€">çˆ¬è™«åŸºç¡€</a><ul>
                                    
                        <li>
                            <a href="#http%e8%af%b7%e6%b1%82%e6%96%b9%e6%b3%95" aria-label="HTTPè¯·æ±‚æ–¹æ³•">HTTPè¯·æ±‚æ–¹æ³•</a><ul>
                                    
                        <li>
                            <a href="#%e8%af%b7%e6%b1%82%e5%a4%b4" aria-label="è¯·æ±‚å¤´">è¯·æ±‚å¤´</a></li>
                        <li>
                            <a href="#%e5%93%8d%e5%ba%94" aria-label="å“åº”">å“åº”</a><ul>
                                    
                        <li>
                            <a href="#%e5%93%8d%e5%ba%94%e5%a4%b4" aria-label="å“åº”å¤´">å“åº”å¤´</a></li></ul>
                        </li></ul>
                        </li>
                        <li>
                            <a href="#%e5%b0%8f%e7%9f%a5%e8%af%86" aria-label="å°çŸ¥è¯†">å°çŸ¥è¯†</a></li>
                        <li>
                            <a href="#%e7%88%ac%e8%99%ab%e5%88%86%e7%b1%bb" aria-label="çˆ¬è™«åˆ†ç±»">çˆ¬è™«åˆ†ç±»</a><ul>
                                    
                        <li>
                            <a href="#%e9%80%9a%e7%94%a8%e7%88%ac%e8%99%ab" aria-label="é€šç”¨çˆ¬è™«">é€šç”¨çˆ¬è™«</a></li>
                        <li>
                            <a href="#%e8%81%9a%e7%84%a6%e7%88%ac%e8%99%ab" aria-label="èšç„¦çˆ¬è™«">èšç„¦çˆ¬è™«</a></li></ul>
                        </li>
                        <li>
                            <a href="#%e7%88%ac%e8%99%ab%e5%ad%a6%e4%b9%a0" aria-label="çˆ¬è™«å­¦ä¹ ">çˆ¬è™«å­¦ä¹ </a><ul>
                                    
                        <li>
                            <a href="#urllibrequesturlopen" aria-label="urllib.request.urlopen()">urllib.request.urlopen()</a></li>
                        <li>
                            <a href="#urllibrequestrequest" aria-label="urllib.request.Request()">urllib.request.Request()</a></li>
                        <li>
                            <a href="#%e7%ae%80%e5%8d%95%e7%9a%84%e7%88%ac%e5%8f%96%e7%bd%91%e9%a1%b5" aria-label="ç®€å•çš„çˆ¬å–ç½‘é¡µ">ç®€å•çš„çˆ¬å–ç½‘é¡µ</a></li>
                        <li>
                            <a href="#beautifulsoup%e5%ba%93%e7%9a%84%e5%9f%ba%e6%9c%ac%e4%bd%bf%e7%94%a8%e7%88%ac%e8%99%ab%e7%9a%84%e8%a7%a3%e6%9e%90" aria-label="BeautifulSoupåº“çš„åŸºæœ¬ä½¿ç”¨(çˆ¬è™«çš„è§£æ)">BeautifulSoupåº“çš„åŸºæœ¬ä½¿ç”¨(çˆ¬è™«çš„è§£æ)</a><ul>
                                    
                        <li>
                            <a href="#beautifulsoup20%e6%96%87%e6%a1%a3%e6%90%9c%e7%b4%a2" aria-label="BeautifulSoup2.0æ–‡æ¡£æœç´¢">BeautifulSoup2.0æ–‡æ¡£æœç´¢</a></li></ul>
                        </li></ul>
                        </li>
                        <li>
                            <a href="#liwei%e7%88%ac%e8%99%ab%e5%ad%a6%e4%b9%a0%e7%9a%84%e6%9c%80%e7%bb%88" aria-label="liweiçˆ¬è™«å­¦ä¹ çš„æœ€ç»ˆ">liweiçˆ¬è™«å­¦ä¹ çš„æœ€ç»ˆ</a></li>
                        <li>
                            <a href="#%e7%88%ac%e8%99%ab%e6%89%80%e7%94%a8%e5%88%b0%e7%9a%84%e5%ba%93" aria-label="çˆ¬è™«æ‰€ç”¨åˆ°çš„åº“">çˆ¬è™«æ‰€ç”¨åˆ°çš„åº“</a></li>
                        <li>
                            <a href="#re%e6%ad%a3%e5%88%99%e8%a1%a8%e8%be%be%e5%bc%8f" aria-label="reæ­£åˆ™è¡¨è¾¾å¼">reæ­£åˆ™è¡¨è¾¾å¼</a>
                        </li>
                    </ul>
                    </li>
                    </ul>
                </div>
            </details>
        </div>
    </aside>
    <script>
        let activeElement;
        let elements;
        window.addEventListener('DOMContentLoaded', function (event) {
            checkTocPosition();

            elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
            
            activeElement = elements[0];
            const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
            document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
        }, false);

        window.addEventListener('resize', function (event) {
            checkTocPosition();
        }, false);

        window.addEventListener('scroll', () => {
            
            activeElement = Array.from(elements).find((element) => {
                if ((getOffsetTop(element) - window.pageYOffset) > 0 &&
                    (getOffsetTop(element) - window.pageYOffset) < window.innerHeight / 2) {
                    return element;
                }
            }) || activeElement

            elements.forEach(element => {
                const id = encodeURI(element.getAttribute('id')).toLowerCase();
                if (element === activeElement) {
                    document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
                } else {
                    document.querySelector(`.inner ul li a[href="#${id}"]`).classList.remove('active');
                }
            })
        }, false);

        const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
        const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
        const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);

        function checkTocPosition() {
            const width = document.body.scrollWidth;

            if (width - main - (toc * 2) - (gap * 4) > 0) {
                document.getElementById("toc-container").classList.add("wide");
            } else {
                document.getElementById("toc-container").classList.remove("wide");
            }
        }

        function getOffsetTop(element) {
            if (!element.getClientRects().length) {
                return 0;
            }
            let rect = element.getBoundingClientRect();
            let win = element.ownerDocument.defaultView;
            return rect.top + win.pageYOffset;
        }
    </script>
  <div class="post-content"><h1 id="çˆ¬è™«åŸºç¡€">çˆ¬è™«åŸºç¡€<a hidden class="anchor" aria-hidden="true" href="#çˆ¬è™«åŸºç¡€">#</a></h1>
<p>çˆ¬è™«åŸºæœ¬æµç¨‹</p>
<p><code>1.åˆå§‹åŒ–URLï¼Œå¹¶å°†URLæ”¾å…¥å¾…çˆ¬å–çš„é˜Ÿåˆ—</code>
<code>2.å°†URlé€šè¿‡DNSè§£æIPï¼Œå°†å¯¹åº”IPçš„ç«™ç‚¹ä¸‹è½½åˆ°HTMLé¡µé¢ï¼Œå¹¶ä¿å­˜åˆ°æœ¬åœ°ï¼Œçˆ¬å–å®Œçš„URLæ”¾åˆ°å·²çˆ¬å–é˜Ÿåˆ—</code>
<code>3.åˆ†æç½‘é¡µå†…å®¹ï¼Œæ‰¾å‡ºç½‘é¡µé‡Œé¢å…³å¿ƒçš„URLé“¾æ¥å’Œå†…å®¹ï¼Œç»§ç»­æ‰§è¡Œç¬¬äºŒæ­¥</code></p>
<ol>
<li>è·å–ç½‘é¡µ</li>
<li>æå–ä¿¡æ¯</li>
<li>ä¿å­˜æ•°æ®</li>
<li>è‡ªåŠ¨åŒ–ç¨‹åº</li>
</ol>
<p>çˆ¬è™«å¦‚æœéœ€è¦æ¨¡æ‹Ÿåˆ™æŠŠè¯¥ç½‘ç«™ä¸‹é¢çš„æ‰€æœ‰è¯·æ±‚ä¿¡æ¯å°è£…(ä¾‹å¦‚UA)ç„¶åå‘é€</p>
<h2 id="httpè¯·æ±‚æ–¹æ³•">HTTPè¯·æ±‚æ–¹æ³•<a hidden class="anchor" aria-hidden="true" href="#httpè¯·æ±‚æ–¹æ³•">#</a></h2>
<p>è¯·æ±‚ï¼Œæ˜¯ç”±å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘å‡ºä¸€èˆ¬åˆ†ä¸º4éƒ¨åˆ†å†…å®¹ï¼šè¯·æ±‚æ–¹æ³•ï¼ˆrequest methodï¼‰ã€è¯·æ±‚çš„ç½‘å€ï¼ˆrequest urlï¼‰ã€è¯·æ±‚å¤´ï¼ˆrequest Headersï¼‰ã€è¯·æ±‚ä½“ï¼ˆrequest Bodyï¼‰</p>
<table>
<thead>
<tr>
<th>1</th>
<th>GET</th>
<th>è¯·æ±‚æŒ‡å®šçš„é¡µé¢ä¿¡æ¯ï¼Œå¹¶è¿”å›å®ä½“ä¸»ä½“ã€‚</th>
</tr>
</thead>
<tbody>
<tr>
<td>2</td>
<td>HEAD</td>
<td>ç±»ä¼¼äº GET è¯·æ±‚ï¼Œåªä¸è¿‡è¿”å›çš„å“åº”ä¸­æ²¡æœ‰å…·ä½“çš„å†…å®¹ï¼Œç”¨äºè·å–æŠ¥å¤´</td>
</tr>
<tr>
<td>3</td>
<td>POST</td>
<td>å‘æŒ‡å®šèµ„æºæäº¤æ•°æ®è¿›è¡Œå¤„ç†è¯·æ±‚ï¼ˆä¾‹å¦‚æäº¤è¡¨å•æˆ–è€…ä¸Šä¼ æ–‡ä»¶ï¼‰ã€‚æ•°æ®è¢«åŒ…å«åœ¨è¯·æ±‚ä½“ä¸­ã€‚POST è¯·æ±‚å¯èƒ½ä¼šå¯¼è‡´æ–°çš„èµ„æºçš„å»ºç«‹å’Œ/æˆ–å·²æœ‰èµ„æºçš„ä¿®æ”¹ã€‚</td>
</tr>
<tr>
<td>4</td>
<td>PUT</td>
<td>ä»å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ä¼ é€çš„æ•°æ®å–ä»£æŒ‡å®šçš„æ–‡æ¡£çš„å†…å®¹ã€‚</td>
</tr>
<tr>
<td>5</td>
<td>DELETE</td>
<td>è¯·æ±‚æœåŠ¡å™¨åˆ é™¤æŒ‡å®šçš„é¡µé¢ã€‚</td>
</tr>
<tr>
<td>6</td>
<td>CONNECT</td>
<td>HTTP/1.1 åè®®ä¸­é¢„ç•™ç»™èƒ½å¤Ÿå°†è¿æ¥æ”¹ä¸ºç®¡é“æ–¹å¼çš„ä»£ç†æœåŠ¡å™¨ã€‚</td>
</tr>
<tr>
<td>7</td>
<td>OPTIONS</td>
<td>å…è®¸å®¢æˆ·ç«¯æŸ¥çœ‹æœåŠ¡å™¨çš„æ€§èƒ½ã€‚</td>
</tr>
<tr>
<td>8</td>
<td>TRACE</td>
<td>å›æ˜¾æœåŠ¡å™¨æ”¶åˆ°çš„è¯·æ±‚ï¼Œä¸»è¦ç”¨äºæµ‹è¯•æˆ–è¯Šæ–­ã€‚</td>
</tr>
<tr>
<td>9</td>
<td>PATCH</td>
<td>æ˜¯å¯¹ PUT æ–¹æ³•çš„è¡¥å……ï¼Œç”¨æ¥å¯¹å·²çŸ¥èµ„æºè¿›è¡Œå±€éƒ¨æ›´æ–° ã€‚</td>
</tr>
</tbody>
</table>
<h3 id="è¯·æ±‚å¤´">è¯·æ±‚å¤´<a hidden class="anchor" aria-hidden="true" href="#è¯·æ±‚å¤´">#</a></h3>
<p>è¯·æ±‚å¤´ï¼Œç”¨æ¥è¯´æ˜æœåŠ¡å™¨è¦ä½¿ç”¨çš„é™„åŠ ä¿¡æ¯ï¼Œæ¯”è¾ƒé‡è¦çš„ä¿¡æ¯æœ‰ï¼Œ<strong>cookieã€Referã€User-Agent</strong></p>
<h3 id="å“åº”">å“åº”<a hidden class="anchor" aria-hidden="true" href="#å“åº”">#</a></h3>
<p>å“åº”ï¼Œç”±æœåŠ¡å™¨ç«¯è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œåˆ†ä¸ºå“åº”çŠ¶æ€ç ï¼ˆResponse Status Codeï¼‰ã€å“åº”å¤´ï¼ˆResponse headersï¼‰ã€å“åº”ä½“ï¼ˆResponse Bodyï¼‰</p>
<h4 id="å“åº”å¤´">å“åº”å¤´<a hidden class="anchor" aria-hidden="true" href="#å“åº”å¤´">#</a></h4>
<p>åŒ…å«äº†æœåŠ¡å™¨å¯¹è¯·æ±‚çš„åº”ç­”ä¿¡æ¯</p>
<hr>
<h2 id="å°çŸ¥è¯†">å°çŸ¥è¯†<a hidden class="anchor" aria-hidden="true" href="#å°çŸ¥è¯†">#</a></h2>
<ul>
<li>Host:åŸŸåã€‚è¡¨ç¤ºè¯·æ±‚çš„æœåŠ¡å™¨ç½‘å€</li>
</ul>
<hr>
<h2 id="çˆ¬è™«åˆ†ç±»">çˆ¬è™«åˆ†ç±»<a hidden class="anchor" aria-hidden="true" href="#çˆ¬è™«åˆ†ç±»">#</a></h2>
<h3 id="é€šç”¨çˆ¬è™«">é€šç”¨çˆ¬è™«<a hidden class="anchor" aria-hidden="true" href="#é€šç”¨çˆ¬è™«">#</a></h3>
<h3 id="èšç„¦çˆ¬è™«">èšç„¦çˆ¬è™«<a hidden class="anchor" aria-hidden="true" href="#èšç„¦çˆ¬è™«">#</a></h3>
<hr>
<h2 id="çˆ¬è™«å­¦ä¹ ">çˆ¬è™«å­¦ä¹ <a hidden class="anchor" aria-hidden="true" href="#çˆ¬è™«å­¦ä¹ ">#</a></h2>
<p><code>urllib.request.urlopen(url, data=None, [timeout, ]*, cafile=None, capath=None, cadefault=False, context=None)</code>æ‰“å¼€ä¸€ä¸ªç½‘é¡µå¹¶æŠŠè·å–è¯¥URLçš„ç½‘é¡µå¯¹è±¡
<em>data</em> å¿…é¡»æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œç”¨äºç»™å‡ºè¦å‘é€åˆ°æœåŠ¡å™¨çš„é™„åŠ æ•°æ®ï¼Œè‹¥ä¸éœ€è¦å‘é€æ•°æ®åˆ™ä¸º <code>None</code>ï¼Œdataæ”¯æŒçš„å¯¹è±¡ç±»å‹åŒ…æ‹¬å­—èŠ‚ä¸²ã€ç±»æ–‡ä»¶å¯¹è±¡å’Œå¯éå†çš„ç±»å­—èŠ‚ä¸²å¯¹è±¡</p>
<h3 id="urllibrequesturlopen">urllib.request.urlopen()<a hidden class="anchor" aria-hidden="true" href="#urllibrequesturlopen">#</a></h3>
<blockquote>
<p>ä¸€ä¸ªç®€å•çš„getè¯·æ±‚çˆ¬å–</p>
</blockquote>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#fff;font-weight:bold">import</span> urllib.request
<span style="color:#fff;font-weight:bold">import</span> urllib.parse     <span style="color:#007f7f">#è§£æå™¨</span>
<span style="color:#fff;font-weight:bold">import</span> urllib.error

<span style="color:#007f7f">#Getè¯·æ±‚</span>
response = urllib.request.urlopen(<span style="color:#0ff;font-weight:bold">&#34;http://www.baidu.com&#34;</span>)
<span style="color:#fff;font-weight:bold">print</span>(response.read().decode(<span style="color:#0ff;font-weight:bold">&#34;UTF-8&#34;</span>))		<span style="color:#007f7f"># responseæ˜¯&lt;http.client.HTTPResponse object at 0x000002DC28A404C0&gt;</span>

url = <span style="color:#0ff;font-weight:bold">&#34;http://httpbin.org/get&#34;</span>
response2 = urllib.request.urlopen(url=url)
<span style="color:#fff;font-weight:bold">print</span>(response2.read().decode(<span style="color:#0ff;font-weight:bold">&#34;UTF-8&#34;</span>))
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>ä¸€ä¸ªç®€å•çš„postè¯·æ±‚(postè¯·æ±‚éœ€è¦æäº¤ä¸ªè¡¨å•ä¿¡æ¯)ï¼Œéœ€è¦æä¾›ä¸€ä¸ªå°è£…çš„æ•°æ®</p>
</blockquote>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#007f7f">#postè¯·æ±‚  éœ€è¦å°è£…æ•°æ®  http://httpbin.org/post</span>
url = <span style="color:#0ff;font-weight:bold">&#34;http://httpbin.org/post&#34;</span>
data = <span style="color:#fff;font-weight:bold">bytes</span>(urllib.parse.urlencode({<span style="color:#0ff;font-weight:bold">&#34;hello&#34;</span>:<span style="color:#0ff;font-weight:bold">&#34;world&#34;</span>}), encoding = <span style="color:#0ff;font-weight:bold">&#34;utf-8&#34;</span>)		<span style="color:#007f7f">#æŠŠæ•°æ®å˜æˆäºŒè¿›åˆ¶æ ¼å¼</span>
response = urllib.request.urlopen(url=url, data=data)
<span style="color:#fff;font-weight:bold">print</span>(response.read().decode(<span style="color:#0ff;font-weight:bold">&#34;utf-8&#34;</span>))
</code></pre></td></tr></table>
</div>
</div><h3 id="urllibrequestrequest">urllib.request.Request()<a hidden class="anchor" aria-hidden="true" href="#urllibrequestrequest">#</a></h3>
<p><code>urllib.request.Request(url, data=None, headers={}, origin_req_host=None, unverifiable=False, method=None)</code>
ä¸Šé¢çš„urlopenè¿‡äºç®€å•ç›´æ¥æŠŠèµ‹å€¼çš„urlç›´æ¥æ‰“å¼€ï¼ŒåŒ…å«ä¸äº†å¤ªå¤šä¼ªè£…ä¿¡æ¯ï¼Œæ‰€ä»¥ä½¿ç”¨==urllib.request.Request()==</p>
<p>headersï¼šå‘Šè¯‰è¦è®¿é—®çš„æœåŠ¡å™¨ï¼Œæˆ‘ä»¬æ˜¯ä»€ä¹ˆç±»å‹çš„æœºå™¨ï¼ˆæµè§ˆå™¨ï¼‰ï¼Œæœ¬è´¨ä¸Šæ˜¯å‘Šè¯‰æµè§ˆå™¨æˆ‘ä»¬å¯ä»¥æ¥å—ä»€ä¹ˆæ°´å¹³çš„æ–‡ä»¶å†…å®¹</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#fff;font-weight:bold">import</span> urllib.request
<span style="color:#fff;font-weight:bold">import</span> urllib.parse     <span style="color:#007f7f">#è§£æå™¨</span>
<span style="color:#fff;font-weight:bold">import</span> urllib.error
<span style="color:#007f7f"># http://httpbin.org/post    https://www.douban.com</span>
url = <span style="color:#0ff;font-weight:bold">&#34;http://httpbin.org/post&#34;</span>
headers = {<span style="color:#0ff;font-weight:bold">&#34;User-Agent&#34;</span>: <span style="color:#0ff;font-weight:bold">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36&#34;</span>
                         <span style="color:#0ff;font-weight:bold">&#34; (KHTML, like Gecko) Chrome/97.0.4692.99 Safari/537.36&#34;</span>}
data = <span style="color:#fff;font-weight:bold">bytes</span>(urllib.parse.urlencode({<span style="color:#0ff;font-weight:bold">&#34;name&#34;</span>:<span style="color:#0ff;font-weight:bold">&#34;hanson&#34;</span>}),encoding = <span style="color:#0ff;font-weight:bold">&#34;UTF-8&#34;</span>)

<span style="color:#007f7f">#å°è£…äº†ä¸€ä¸ªè¯·æ±‚å¯¹è±¡</span>
req = urllib.request.Request(url=url, data=data, headers=headers)   

response = urllib.request.urlopen(req)	<span style="color:#007f7f">#å“åº”å¯¹è±¡</span>
<span style="color:#fff;font-weight:bold">print</span>(response.read().decode(<span style="color:#0ff;font-weight:bold">&#34;UTF-8&#34;</span>))
</code></pre></td></tr></table>
</div>
</div><h3 id="ç®€å•çš„çˆ¬å–ç½‘é¡µ">ç®€å•çš„çˆ¬å–ç½‘é¡µ<a hidden class="anchor" aria-hidden="true" href="#ç®€å•çš„çˆ¬å–ç½‘é¡µ">#</a></h3>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">46
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">47
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#fff;font-weight:bold">import</span> urllib.request
<span style="color:#fff;font-weight:bold">import</span> urllib.error

<span style="color:#fff;font-weight:bold">def</span> main():
    <span style="color:#007f7f">#åŸºç¡€çš„URL</span>
    <span style="color:#007f7f"># 1.çˆ¬å–ç½‘é¡µ</span>
    baseurl = <span style="color:#0ff;font-weight:bold">&#34;https://movie.douban.com/top250?start=&#34;</span>
    savepath = <span style="color:#0ff;font-weight:bold">r</span><span style="color:#0ff;font-weight:bold">&#34;D:\project\python pycharm\datasave\douban_data.xlsx&#34;</span>
    <span style="color:#007f7f"># datalist = getData(baseurl)</span>
    getData(baseurl)
    <span style="color:#007f7f">#2.è§£ææ•°æ®</span>


    <span style="color:#007f7f">#3.ä¿å­˜æ•°æ®</span>
    <span style="color:#007f7f"># saveData(savepath)</span>

<span style="color:#fff;font-weight:bold">def</span> getData(baseurl):
    datalist = []
    <span style="color:#fff;font-weight:bold">for</span> i in <span style="color:#fff;font-weight:bold">range</span>(<span style="color:#ff0;font-weight:bold">0</span>, <span style="color:#ff0;font-weight:bold">10</span>):
        url = baseurl + <span style="color:#fff;font-weight:bold">str</span>(i*<span style="color:#ff0;font-weight:bold">25</span>)
        html = askurl(url)

    <span style="color:#fff;font-weight:bold">return</span> datalist

    <span style="color:#007f7f"># 3.ä¿å­˜æ•°æ®,åœ¨æœ¬åˆ—å­ä¸­æš‚æ—¶ä¸ç”¨</span>
<span style="color:#fff;font-weight:bold">def</span> saveData(savepath):
    <span style="color:#fff;font-weight:bold">pass</span>

<span style="color:#007f7f"># å¾—åˆ°ä¸€ä¸ªæŒ‡å®šçš„URLçš„ç½‘é¡µå†…å®¹</span>
<span style="color:#fff;font-weight:bold">def</span> askurl(url):
    head = {
        <span style="color:#0ff;font-weight:bold">&#34;User-Agent&#34;</span>: <span style="color:#0ff;font-weight:bold">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36&#34;</span>
                      <span style="color:#0ff;font-weight:bold">&#34; (KHTML, like Gecko) Chrome/97.0.4692.99 Safari/537.36&#34;</span>
    }
    html = <span style="color:#0ff;font-weight:bold">&#34;&#34;</span>
    <span style="color:#fff;font-weight:bold">try</span>:
        req = urllib.request.Request(url=url, headers=head)
        response = urllib.request.urlopen(req)
        html= response.read().decode(<span style="color:#0ff;font-weight:bold">&#34;UTF-8&#34;</span>)
        <span style="color:#fff;font-weight:bold">print</span>(html)
    <span style="color:#fff;font-weight:bold">except</span> Exception <span style="color:#fff;font-weight:bold">as</span> e:
        <span style="color:#fff;font-weight:bold">print</span>(e)
    <span style="color:#fff;font-weight:bold">return</span> html


<span style="color:#fff;font-weight:bold">if</span> __name__ == <span style="color:#0ff;font-weight:bold">&#34;__main__&#34;</span>:
    main()
</code></pre></td></tr></table>
</div>
</div><h3 id="beautifulsoupåº“çš„åŸºæœ¬ä½¿ç”¨çˆ¬è™«çš„è§£æ">BeautifulSoupåº“çš„åŸºæœ¬ä½¿ç”¨(çˆ¬è™«çš„è§£æ)<a hidden class="anchor" aria-hidden="true" href="#beautifulsoupåº“çš„åŸºæœ¬ä½¿ç”¨çˆ¬è™«çš„è§£æ">#</a></h3>
<p>BeautifulSoup4å°†HTMLæ–‡æ¡£è½¬æ¢æˆæ ‘å½¢ç»“æ„ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯Pythonå¯¹è±¡ï¼Œå½’ç±»æˆå››ç§ï¼š</p>
<ol>
<li>Tag	å¯ä»¥è·å–æ ‡ç­¾åŠå…¶æ ‡ç­¾å†…å®¹</li>
<li>NavigableString</li>
<li>BeautifulSoup</li>
<li>comment</li>
</ol>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#fff;font-weight:bold">import</span> bs4
<span style="color:#fff;font-weight:bold">with</span> <span style="color:#fff;font-weight:bold">open</span>(<span style="color:#0ff;font-weight:bold">&#34;../baidu.html&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;rb&#34;</span>) <span style="color:#fff;font-weight:bold">as</span> file:
    htmlread = file.read()
    bs = bs4.BeautifulSoup(htmlread, <span style="color:#0ff;font-weight:bold">&#34;html.parser&#34;</span>)

    <span style="color:#007f7f"># Tag è·å–æ ‡ç­¾åŠå†…å®¹</span>
    <span style="color:#fff;font-weight:bold">print</span>(bs.title)     <span style="color:#007f7f">#output: &lt;title&gt;ç™¾åº¦ä¸€ä¸‹ï¼Œä½ å°±çŸ¥é“ &lt;/title&gt;</span>
    <span style="color:#fff;font-weight:bold">print</span>(bs.a)         <span style="color:#007f7f">#output: &lt;a class=&#34;mnav&#34; href=&#34;http://news.baidu.com&#34; name=&#34;tj_trnews&#34;&gt;&lt;!--æ–°é—»--&gt;&lt;/a&gt;</span>
    <span style="color:#007f7f"># è·å–æ ‡ç­¾é‡Œé¢çš„å†…å®¹</span>
    <span style="color:#fff;font-weight:bold">print</span>(bs.title.string)      <span style="color:#007f7f">#output: ç™¾åº¦ä¸€ä¸‹ï¼Œä½ å°±çŸ¥é“</span>
    <span style="color:#fff;font-weight:bold">print</span>(bs.a.string)          <span style="color:#007f7f">#output: æ–°é—»</span>

    <span style="color:#007f7f"># NavigableString è·å–æ ‡ç­¾é‡Œçš„æ‰€æœ‰å±æ€§ï¼Œå¹¶è¿”å›ä¸€ä¸ªå­—å…¸</span>
    <span style="color:#fff;font-weight:bold">print</span>(bs.a.attrs)   <span style="color:#007f7f">#attrsæ˜¯attributeå±æ€§çš„ç¼©å†™</span>

    <span style="color:#007f7f"># print(bs)    æ‰“å°æ•´ä¸ªhtmlæ–‡ä»¶</span>

    <span style="color:#007f7f"># æ–‡ä»¶çš„éå† contents</span>
    <span style="color:#fff;font-weight:bold">print</span>(<span style="color:#0ff;font-weight:bold">&#34;-----æ–‡æ¡£çš„éå†-----&#34;</span>)
    <span style="color:#fff;font-weight:bold">print</span>(bs.head.contents)     <span style="color:#007f7f">#è¿”å›ä¸€ä¸ªåˆ—è¡¨</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="beautifulsoup20æ–‡æ¡£æœç´¢">BeautifulSoup2.0æ–‡æ¡£æœç´¢<a hidden class="anchor" aria-hidden="true" href="#beautifulsoup20æ–‡æ¡£æœç´¢">#</a></h4>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">45
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#fff;font-weight:bold">import</span> re
<span style="color:#fff;font-weight:bold">import</span> bs4
<span style="color:#fff;font-weight:bold">with</span> <span style="color:#fff;font-weight:bold">open</span>(<span style="color:#0ff;font-weight:bold">&#34;../baidu.html&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;rb&#34;</span>) <span style="color:#fff;font-weight:bold">as</span> file:
    htmlread = file.read()
    bs = bs4.BeautifulSoup(htmlread, <span style="color:#0ff;font-weight:bold">&#34;html.parser&#34;</span>)

    <span style="color:#007f7f">#æ–‡æ¡£æœç´¢</span>
    <span style="color:#007f7f"># 1. find_all()æ–¹æ³•:å­—ç¬¦ä¸²è¿‡æ»¤ä¼šæŸ¥æ‰¾ä¸å­—ç¬¦ä¸²å®Œå…¨åŒ¹é…çš„å†…å®¹</span>
    <span style="color:#fff;font-weight:bold">list</span> = bs.find_all(<span style="color:#0ff;font-weight:bold">&#34;a&#34;</span>)
    <span style="color:#007f7f"># list = bs.find_all(&#34;a&#34;, limit = 3)   limité™åˆ¶å¤šå°‘</span>
    <span style="color:#fff;font-weight:bold">print</span>(<span style="color:#fff;font-weight:bold">list</span>)

    <span style="color:#007f7f">#æ­£åˆ™è¡¨è¾¾å¼æœç´¢</span>
    <span style="color:#fff;font-weight:bold">print</span>(<span style="color:#0ff;font-weight:bold">&#34;---æ­£åˆ™è¡¨è¾¾å¼æœç´¢---&#34;</span>)
    re_list = bs.find_all(re.compile(<span style="color:#0ff;font-weight:bold">&#34;a&#34;</span>))
    <span style="color:#fff;font-weight:bold">print</span>(re_list)
    <span style="color:#fff;font-weight:bold">print</span>(<span style="color:#fff;font-weight:bold">len</span>(re_list))

    <span style="color:#007f7f">#ä¼ å…¥ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°è¿›è¡Œæœç´¢,æŒ‰ç…§å‡½æ•°è¿›è¡Œæœç´¢</span>
    <span style="color:#fff;font-weight:bold">print</span>(<span style="color:#0ff;font-weight:bold">&#34;---å‡½æ•°æœç´¢---&#34;</span>)
    <span style="color:#fff;font-weight:bold">def</span> name_is_exists(tag):
        <span style="color:#fff;font-weight:bold">return</span> tag.has_attr(<span style="color:#0ff;font-weight:bold">&#34;name&#34;</span>)
    funcres = bs.find_all(name_is_exists)
    <span style="color:#fff;font-weight:bold">print</span>(funcres)

    <span style="color:#007f7f">#kwargså…³é”®å­—æœç´¢</span>
    <span style="color:#fff;font-weight:bold">print</span>(<span style="color:#0ff;font-weight:bold">&#34;----kwargså…³é”®å­—æœç´¢----&#34;</span>)
    kwlist = bs.find_all(<span style="color:#fff;font-weight:bold">id</span> = <span style="color:#0ff;font-weight:bold">&#34;head&#34;</span>)
    kwlist2 = bs.find_all(href = <span style="color:#0ff;font-weight:bold">&#34;https://www.hao123.com&#34;</span>)
    kwlist3 = bs.find_all(class_ = <span style="color:#fff;font-weight:bold">True</span>)    <span style="color:#007f7f">#è¿™é‡ŒclassåŠ ä¸‹åˆ’çº¿æ˜¯å› ä¸ºclassæ˜¯Pythonçš„å…³é”®å­—</span>
    <span style="color:#fff;font-weight:bold">print</span>(kwlist3)

    <span style="color:#007f7f">#textæ–‡æœ¬å‚æ•°,æŸ¥æ‰¾æ ‡ç­¾é‡Œçš„å­—ç¬¦ä¸²</span>
    <span style="color:#fff;font-weight:bold">print</span>(<span style="color:#0ff;font-weight:bold">&#34;----textæ–‡æœ¬å‚æ•°-----&#34;</span>)
    ts_list = bs.find_all(text=<span style="color:#0ff;font-weight:bold">&#34;hao123&#34;</span>)
    ts_list2 = bs.find_all(text=[<span style="color:#0ff;font-weight:bold">&#34;hao123&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;åœ°å›¾&#34;</span>])
    <span style="color:#fff;font-weight:bold">print</span>(ts_list2)

    <span style="color:#007f7f">#cssé€‰æ‹©å™¨,å’Œcssé€‰æ‹©å™¨çš„è¯­æ³•ä¸€æ ·</span>
    <span style="color:#fff;font-weight:bold">print</span>(<span style="color:#0ff;font-weight:bold">&#34;------cssé€‰æ‹©å™¨-------&#34;</span>)
    css_list = bs.select(<span style="color:#0ff;font-weight:bold">&#34;title&#34;</span>)
    css_list2 = bs.select(<span style="color:#0ff;font-weight:bold">&#34;.mnav&#34;</span>)
    css_list3 = bs.select(<span style="color:#0ff;font-weight:bold">&#34;#u1&#34;</span>)
    css_list4 = bs.select(<span style="color:#0ff;font-weight:bold">&#34;a[class = &#39;bri&#39;]&#34;</span>)
    <span style="color:#fff;font-weight:bold">print</span>(css_list3)
</code></pre></td></tr></table>
</div>
</div><h2 id="liweiçˆ¬è™«å­¦ä¹ çš„æœ€ç»ˆ">liweiçˆ¬è™«å­¦ä¹ çš„æœ€ç»ˆ<a hidden class="anchor" aria-hidden="true" href="#liweiçˆ¬è™«å­¦ä¹ çš„æœ€ç»ˆ">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 46
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 47
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 48
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 49
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 50
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 51
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 52
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 53
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 54
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 55
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 56
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 57
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 58
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 59
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 60
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 61
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 62
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 63
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 64
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 65
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 66
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 67
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 68
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 69
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 70
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 71
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 72
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 73
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 74
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 75
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 76
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 77
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 78
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 79
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 80
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 81
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 82
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 83
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 84
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 85
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 86
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 87
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 88
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 89
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 90
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 91
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 92
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 93
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 94
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 95
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 96
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 97
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 98
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 99
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">100
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">101
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">102
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">103
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">104
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">105
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">106
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">107
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">108
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#007f7f"># coding:utf-8</span>
<span style="color:#007f7f"># @Time : 2022/5/7 9:57</span>
<span style="color:#007f7f"># @Author : è½¯ä»¶1194æ¸©é“­å†›</span>
<span style="color:#007f7f"># @file : ts.py</span>
<span style="color:#007f7f"># $software : PyCharm</span>
<span style="color:#fff;font-weight:bold">import</span> bs4
<span style="color:#fff;font-weight:bold">import</span> re
<span style="color:#fff;font-weight:bold">import</span> xlwt
<span style="color:#fff;font-weight:bold">import</span> urllib.request
<span style="color:#fff;font-weight:bold">import</span> urllib.error

<span style="color:#fff;font-weight:bold">def</span> main():
    baseurl = <span style="color:#0ff;font-weight:bold">&#34;https://movie.douban.com/top250?start=&#34;</span>  <span style="color:#007f7f">#å¾…çˆ¬å–çš„URL</span>
    savepath = <span style="color:#0ff;font-weight:bold">r</span><span style="color:#0ff;font-weight:bold">&#34;D:\project\python pycharm\datasave\douban_data.xls&#34;</span>    <span style="color:#007f7f">#ä¿å­˜ä½ç½®</span>
    datalist = getData(baseurl)     <span style="color:#007f7f">#çˆ¬å–åˆ°çš„æ•°æ®åˆ—è¡¨</span>
    <span style="color:#007f7f"># getData(baseurl)</span>
    <span style="color:#007f7f"># print(datalist)</span>
    <span style="color:#007f7f">#3.ä¿å­˜æ•°æ®</span>
    saveData(datalist,savepath)

<span style="color:#007f7f"># æå–å½±ç‰‡çš„æå–è§„åˆ™</span>
recom_link = re.compile(<span style="color:#0ff;font-weight:bold">r</span><span style="color:#0ff;font-weight:bold">&#39;&lt;a href=&#34;(.*?)&#34;&gt;&#39;</span>)
recom_img = re.compile(<span style="color:#0ff;font-weight:bold">r</span><span style="color:#0ff;font-weight:bold">&#39;&lt;img alt=&#34;.*? src=&#34;(.*?)&#34;.*?/&gt;&#39;</span>, re.S)     <span style="color:#007f7f">#re.Sè®©æ¢è¡Œç¬¦ä¹ŸåŒ…å«åœ¨å†…</span>
recom_title = re.compile(<span style="color:#0ff;font-weight:bold">r</span><span style="color:#0ff;font-weight:bold">&#39;&lt;span class=&#34;title&#34;&gt;(.*?)&lt;/span&gt;&#39;</span>)
recom_rating = re.compile(<span style="color:#0ff;font-weight:bold">r</span><span style="color:#0ff;font-weight:bold">&#39;&lt;span class=&#34;rating_num&#34; property=&#34;v:average&#34;&gt;(.*?)&lt;/span&gt;&#39;</span>)
recom_judge = re.compile(<span style="color:#0ff;font-weight:bold">r</span><span style="color:#0ff;font-weight:bold">&#39;&lt;span&gt;(\d*)äººè¯„ä»·&lt;/span&gt;&#39;</span>)
recom_inq = re.compile(<span style="color:#0ff;font-weight:bold">r</span><span style="color:#0ff;font-weight:bold">&#39;&lt;span class=&#34;inq&#34;&gt;(.*?)&lt;/span&gt;&#39;</span>)
recom_db = re.compile(<span style="color:#0ff;font-weight:bold">r</span><span style="color:#0ff;font-weight:bold">&#39;&lt;p class=&#34;&#34;&gt;(.*?)&lt;/p&gt;&#39;</span>,re.S)

<span style="color:#fff;font-weight:bold">def</span> getData(baseurl):
    datalist = []
    <span style="color:#007f7f">#ç”Ÿæˆè¦çˆ¬å–çš„ç½‘å€</span>
    <span style="color:#fff;font-weight:bold">for</span> i in <span style="color:#fff;font-weight:bold">range</span>(<span style="color:#ff0;font-weight:bold">0</span>, <span style="color:#ff0;font-weight:bold">10</span>):
        url = baseurl + <span style="color:#fff;font-weight:bold">str</span>(i*<span style="color:#ff0;font-weight:bold">25</span>)
        html = askurl(url)

        <span style="color:#007f7f">#è¿›è¡Œæ•°æ®è§£æ</span>
        soup = bs4.BeautifulSoup(html, <span style="color:#0ff;font-weight:bold">&#34;html.parser&#34;</span>)
        <span style="color:#fff;font-weight:bold">for</span> item in soup.find_all(<span style="color:#0ff;font-weight:bold">&#34;div&#34;</span>, class_ = <span style="color:#0ff;font-weight:bold">&#34;item&#34;</span>):	<span style="color:#007f7f">#åœ¨&lt;class &#39;bs4.BeautifulSoup&#39;&gt;ä¸­æŸ¥æ‰¾æ˜¯divå¹¶ä¸”class=&#34;item&#34;çš„å†…å®¹</span>
            <span style="color:#007f7f"># print(item)</span>
            data = []   <span style="color:#007f7f">#ä¿å­˜æ¯ä¸€éƒ¨ç”µå½±çš„ä¿¡æ¯</span>
            item = <span style="color:#fff;font-weight:bold">str</span>(item)
            link = re.findall(recom_link, item)[<span style="color:#ff0;font-weight:bold">0</span>]
            data.append(link)   <span style="color:#007f7f">#æ·»åŠ é“¾æ¥</span>
            img = re.findall(recom_img, item)[<span style="color:#ff0;font-weight:bold">0</span>]
            data.append(img)
            title = re.findall(recom_title, item)
            <span style="color:#fff;font-weight:bold">if</span> (<span style="color:#fff;font-weight:bold">len</span>(title) ==<span style="color:#ff0;font-weight:bold">2</span>):
                ctitle = title[<span style="color:#ff0;font-weight:bold">0</span>]
                data.append(ctitle)
                otitle = title[<span style="color:#ff0;font-weight:bold">1</span>].replace(<span style="color:#0ff;font-weight:bold">&#34;/&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;&#34;</span>)   <span style="color:#007f7f">#å»æ‰æ— å…³ç¬¦å·</span>
                data.append(otitle)
            <span style="color:#fff;font-weight:bold">else</span>:
                data.append(title[<span style="color:#ff0;font-weight:bold">0</span>])
                data.append(<span style="color:#0ff;font-weight:bold">&#34; &#34;</span>)    <span style="color:#007f7f">#ç•™ç©º</span>
            rating = re.findall(recom_rating, item)[<span style="color:#ff0;font-weight:bold">0</span>]
            data.append(rating)
            judge = re.findall(recom_judge, item)[<span style="color:#ff0;font-weight:bold">0</span>]
            data.append(judge)
            inq = re.findall(recom_inq, item)
            <span style="color:#fff;font-weight:bold">if</span> <span style="color:#fff;font-weight:bold">len</span>(inq) !=<span style="color:#ff0;font-weight:bold">0</span>:
                inq = inq[<span style="color:#ff0;font-weight:bold">0</span>].replace(<span style="color:#0ff;font-weight:bold">&#34;ã€‚&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34; &#34;</span>)
                data.append(inq)
            <span style="color:#fff;font-weight:bold">else</span>:
                data.append(<span style="color:#0ff;font-weight:bold">&#34; &#34;</span>)
            db = re.findall(recom_db, item)[<span style="color:#ff0;font-weight:bold">0</span>]
            db = re.sub(<span style="color:#0ff;font-weight:bold">&#39;&lt;br(\s+)?/&gt;(\s+)?&#39;</span>, <span style="color:#0ff;font-weight:bold">&#34;&#34;</span>, db)
            db = re.sub(<span style="color:#0ff;font-weight:bold">&#39;/&#39;</span>, <span style="color:#0ff;font-weight:bold">&#34; &#34;</span>, db)
            data.append(db.strip())
            datalist.append(data)
    <span style="color:#007f7f"># print(datalist)</span>
    <span style="color:#fff;font-weight:bold">return</span> datalist

    <span style="color:#007f7f"># 3.ä¿å­˜æ•°æ®</span>
<span style="color:#fff;font-weight:bold">def</span> saveData(datalist,savepath):
    wb = xlwt.Workbook(encoding=<span style="color:#0ff;font-weight:bold">&#34;UTF-8&#34;</span>)
    ws = wb.add_sheet(<span style="color:#0ff;font-weight:bold">&#34;douban_dataTOP250&#34;</span>)
    col = (<span style="color:#0ff;font-weight:bold">&#34;ç”µå½±è¯¦æƒ…é“¾æ¥&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;å›¾ç‰‡é“¾æ¥&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;å½±ç‰‡ä¸­æ–‡å&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;å½±ç‰‡å¤–å›½å&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;è¯„åˆ†&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;è¯„ä»·æ•°&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;æ¦‚å†µ&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;ç›¸å…³ä¿¡æ¯&#34;</span>)
    <span style="color:#fff;font-weight:bold">for</span> i in <span style="color:#fff;font-weight:bold">range</span>(<span style="color:#ff0;font-weight:bold">0</span>,<span style="color:#ff0;font-weight:bold">8</span>):
        ws.write(<span style="color:#ff0;font-weight:bold">0</span>,i,col[i]) <span style="color:#007f7f">#åˆ—å</span>
    <span style="color:#fff;font-weight:bold">for</span> i in <span style="color:#fff;font-weight:bold">range</span>(<span style="color:#ff0;font-weight:bold">0</span>,<span style="color:#ff0;font-weight:bold">250</span>):
        <span style="color:#fff;font-weight:bold">print</span>(<span style="color:#0ff;font-weight:bold">&#34;ç¬¬</span><span style="color:#0ff;font-weight:bold">%d</span><span style="color:#0ff;font-weight:bold">æ¡&#34;</span> %(i+<span style="color:#ff0;font-weight:bold">1</span>))
        data = datalist[i]
        <span style="color:#fff;font-weight:bold">for</span> j in <span style="color:#fff;font-weight:bold">range</span>(<span style="color:#ff0;font-weight:bold">0</span>,<span style="color:#ff0;font-weight:bold">8</span>):
            ws.write(i+<span style="color:#ff0;font-weight:bold">1</span>,j,data[j])      <span style="color:#007f7f">#å†™å…¥æ•°æ®</span>

    wb.save(savepath)       <span style="color:#007f7f">#ä¿å­˜</span>

<span style="color:#007f7f"># å¾—åˆ°ä¸€ä¸ªæŒ‡å®šçš„URLçš„ç½‘é¡µå†…å®¹</span>
<span style="color:#fff;font-weight:bold">def</span> askurl(url):
    head = {
        <span style="color:#0ff;font-weight:bold">&#34;User-Agent&#34;</span>: <span style="color:#0ff;font-weight:bold">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36&#34;</span>
                      <span style="color:#0ff;font-weight:bold">&#34; (KHTML, like Gecko) Chrome/97.0.4692.99 Safari/537.36&#34;</span>
    }
    html = <span style="color:#0ff;font-weight:bold">&#34;&#34;</span>
    <span style="color:#fff;font-weight:bold">try</span>:
        req = urllib.request.Request(url=url, headers=head)
        response = urllib.request.urlopen(req)
        html= response.read().decode(<span style="color:#0ff;font-weight:bold">&#34;UTF-8&#34;</span>)
        <span style="color:#007f7f"># print(html)</span>
    <span style="color:#fff;font-weight:bold">except</span> Exception <span style="color:#fff;font-weight:bold">as</span> e:
        <span style="color:#fff;font-weight:bold">print</span>(e)
    <span style="color:#fff;font-weight:bold">return</span> html


<span style="color:#fff;font-weight:bold">if</span> __name__ == <span style="color:#0ff;font-weight:bold">&#34;__main__&#34;</span>:
    main()
    <span style="color:#fff;font-weight:bold">print</span>(<span style="color:#0ff;font-weight:bold">&#34;çˆ¬å–å®Œæ¯•&#34;</span>)
</code></pre></td></tr></table>
</div>
</div><h2 id="çˆ¬è™«æ‰€ç”¨åˆ°çš„åº“">çˆ¬è™«æ‰€ç”¨åˆ°çš„åº“<a hidden class="anchor" aria-hidden="true" href="#çˆ¬è™«æ‰€ç”¨åˆ°çš„åº“">#</a></h2>
<p>bs4(beautifulsoup)</p>
<p>urllib</p>
<h2 id="reæ­£åˆ™è¡¨è¾¾å¼">reæ­£åˆ™è¡¨è¾¾å¼<a hidden class="anchor" aria-hidden="true" href="#reæ­£åˆ™è¡¨è¾¾å¼">#</a></h2>
<ul>
<li>re.L è¡¨ç¤ºç‰¹æ®Šå­—ç¬¦é›† \w, \W, \b, \B, \s, \S ä¾èµ–äºå½“å‰ç¯å¢ƒ</li>
<li>re.M å¤šè¡Œæ¨¡å¼</li>
<li>re.S å³ä¸º' . &lsquo;å¹¶ä¸”<strong>åŒ…æ‹¬æ¢è¡Œç¬¦åœ¨å†…çš„ä»»æ„å­—ç¬¦</strong>ï¼ˆ&rsquo; . &lsquo;ä¸åŒ…æ‹¬æ¢è¡Œç¬¦ï¼‰</li>
<li>re.U è¡¨ç¤ºç‰¹æ®Šå­—ç¬¦é›† \w, \W, \b, \B, \d, \D, \s, \S ä¾èµ–äº Unicode å­—ç¬¦å±æ€§æ•°æ®åº“</li>
<li>re.X ä¸ºäº†å¢åŠ å¯è¯»æ€§ï¼Œå¿½ç•¥ç©ºæ ¼å’Œ&rsquo; # &lsquo;åé¢çš„æ³¨é‡Š</li>
</ul>
<hr>
<p>==æ³¨æ„==:</p>
<ol>
<li>é™¤äº†txtçº¯æ–‡æœ¬æ–‡ä»¶ä½¿ç”¨ræ¥è¯»å–ï¼Œå…¶ä»–ç±»å‹çš„æ–‡ä»¶éƒ½æ˜¯äºŒè¿›åˆ¶æ–‡ä»¶ç”¨rbè¯»å–</li>
<li>ä¹±ç é—®é¢˜ï¼šPythonå†…å­˜å±‚é¢ä½¿ç”¨çš„æ˜¯Unicodeç¼–ç ï¼Œè€ŒUnicodeä¸èƒ½å­˜å‚¨å’Œä¼ è¾“çš„ï¼Œå¿…é¡»æŠŠUnicodeç¼–ç è¿›è¡Œè½¬ç (å†™æ–‡ä»¶æ—¶è¦ç¼–ç ï¼Œè¯»æ–‡ä»¶æ—¶è¦è§£ç )ï¼Œè½¬æ¢æˆUTF-8æˆ–è€…GBK</li>
<li>å¾—åˆ°çš„b&rsquo;å­—ç¬¦ä¸²&rsquo;æ˜¯==å­—èŠ‚==ï¼Œéœ€è¦è½¬ç </li>
<li>åœ¨å·²ç»çˆ¬å–å¾—åˆ°ç½‘é¡µåè¿›è¡Œæ•°æ®è§£ææ—¶ï¼Œå¦‚æœæµ‹è¯•æ­£åˆ™è¡¨è¾¾å¼æ²¡æœ‰é—®é¢˜ä½†ä»æ— æ•°æ®æ—¶ï¼Œå¯ä»¥åŠ ä¸Šre.Sä¹‹ç±»çš„<code>re.compile(pattern[, flags])</code>çš„flagå‚æ•°</li>
<li>å½“ä½¿ç”¨BeautifulSoupçš„find(å‚æ•°)å‚æ•°ä¸­å‡ºç°Pythonå…³é”®å­—æ—¶å¯ä»¥åœ¨å…³é”®å­—åé¢åŠ __(PS: <code>class_ = &quot;å€¼&quot;</code>)</li>
</ol>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#007f7f">#å¦‚ä¸‹é¢ä¸¤ç§å†™æ³•ä¸€æ ·</span>
find(classs_=<span style="color:#0ff;font-weight:bold">&#34;table&#34;</span>)
find(attrs={<span style="color:#0ff;font-weight:bold">&#34;class&#34;</span>:<span style="color:#0ff;font-weight:bold">&#34;table&#34;</span>})
</code></pre></td></tr></table>
</div>
</div><ol start="6">
<li>BeautifulSoupä¸­å¦‚æœæƒ³æ‹¿åˆ°æŸä¸ªå±æ€§çš„å€¼ï¼Œå¯ä»¥ä½¿ç”¨get(&ldquo;è¦è·å–çš„å±æ€§å&rdquo;)æ–¹æ³•</li>
</ol>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://hanson00.github.io/tags/%E7%88%AC%E8%99%AB/">çˆ¬è™«</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://hanson00.github.io/posts/technology/python/%E8%B7%AF%E9%A3%9E%E7%88%AC%E8%99%AB%E8%BF%9B%E9%98%B6%E7%88%AC%E8%99%AB/">
    <span class="title">Â« Prev</span>
    <br>
    <span>è·¯é£çˆ¬è™«è¿›é˜¶çˆ¬è™«</span>
  </a>
  <a class="next" href="https://hanson00.github.io/posts/technology/golang/01gin/">
    <span class="title">Next Â»</span>
    <br>
    <span>01gin</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2022 <a href="https://hanson00.github.io/">Hanson&#39;s Blog</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
